{"version":3,"sources":["components/LoginPage/video-logo.png","components/VideoProvider/useSelectedParticipant/useSelectedParticipant.tsx","components/VideoProvider/useLocalTracks/useLocalTracks.ts","components/VideoProvider/index.tsx","components/VideoProvider/useRoom/useRoom.tsx","components/VideoProvider/useHandleRoomDisconnectionErrors/useHandleRoomDisconnectionErrors.ts","components/VideoProvider/useHandleTrackPublicationFailed/useHandleTrackPublicationFailed.ts","components/VideoProvider/useHandleOnDisconnect/useHandleOnDisconnect.ts","hooks/useVideoContext/useVideoContext.ts","components/Controls/EndCallButton/EndCallButton.tsx","hooks/useLocalAudioToggle/useLocalAudioToggle.tsx","hooks/useIsTrackEnabled/useIsTrackEnabled.tsx","components/Controls/ToggleAudioButton/ToggleAudioButton.tsx","components/Controls/ToggleVideoButton/ToggleVideoButton.tsx","hooks/useLocalVideoToggle/useLocalVideoToggle.tsx","hooks/useScreenShareParticipant/useScreenShareParticipant.tsx","components/Controls/ToogleScreenShareButton/ToggleScreenShareButton.tsx","hooks/useScreenShareToggle/useScreenShareToggle.tsx","hooks/useRoomState/useRoomState.tsx","components/Controls/Controls.tsx","components/Controls/useIsUserActive/useIsUserActive.ts","components/VideoTrack/VideoTrack.tsx","components/LocalVideoPreview/LocalVideoPreview.tsx","components/ToggleFullScreenButton/ToggleFullScreenButton.tsx","hooks/useFullScreenToggle/useFullScreenToggle.tsx","components/MenuBar/AboutDialog/AboutDialog.tsx","components/MenuBar/UserAvatar/UserAvatar.tsx","state/useFirebaseAuth/useFirebaseAuth.ts","state/usePasscodeAuth/usePasscodeAuth.ts","state/index.tsx","components/MenuBar/Menu/Menu.tsx","components/MenuBar/MenuBar.tsx","components/ReconnectingNotification/ReconnectingNotification.tsx","components/BandwidthWarning/BandwidthWarning.tsx","components/NewtorkQualityLevel/NetworkQualityLevel.tsx","components/ParticipantInfo/ParticipantConnectionIndicator/ParticipantConnectionIndicator.tsx","hooks/useParticipantIsReconnecting/useParticipantIsReconnecting.ts","components/ParticipantInfo/PinIcon/PinIcon.tsx","hooks/usePublications/usePublications.tsx","hooks/useIsTrackSwitchedOff/useIsTrackSwitchedOff.tsx","hooks/useTrack/useTrack.tsx","components/ParticipantInfo/ParticipantInfo.tsx","hooks/useParticipantNetworkQualityLevel/useParticipantNetworkQualityLevel.tsx","hooks/usePublicationIsTrackEnabled/usePublicationIsTrackEnabled.tsx","components/AudioTrack/AudioTrack.tsx","components/Publication/Publication.tsx","components/ParticipantTracks/ParticipantTracks.tsx","components/Participant/Participant.tsx","hooks/useDominantSpeaker/useDominantSpeaker.tsx","hooks/useParticipants/useParticipants.tsx","components/ParticipantStrip/ParticipantStrip.tsx","components/MainParticipantInfo/MainParticipantInfo.tsx","components/MainParticipant/MainParticipant.tsx","hooks/useMainSpeaker/useMainSpeaker.tsx","components/Room/Room.tsx","App.tsx","components/ErrorDialog/ErrorDialog.tsx","components/ErrorDialog/enhanceMessage.ts","components/LoginPage/google-logo.svg","components/LoginPage/twilio-logo.svg","components/LoginPage/LoginPage.tsx","components/PrivateRoute/PrivateRoute.tsx","theme.ts","index.tsx"],"names":["module","exports","selectedParticipantContext","createContext","useSelectedParticipant","useContext","SelectedParticipantProvider","room","children","useState","selectedParticipant","_setSelectedParticipant","useEffect","onDisconnect","on","off","Provider","value","participant","prevParticipant","useLocalTracks","audioTrack","track","setTrack","Video","createLocalAudioTrack","then","newTrack","handleStopped","undefined","useLocalAudioTrack","getLocalVideoTrack","useCallback","createLocalVideoTrack","frameRate","height","width","name","useLocalVideoTrack","videoTrack","localTracks","filter","VideoContext","VideoProvider","options","onError","onErrorCallback","error","console","log","message","EventEmitter","setRoom","isConnecting","setIsConnecting","disconnectHandlerRef","useRef","localTracksRef","current","connect","token","tracks","newRoom","once","setTimeout","window","removeEventListener","twilioRoom","forEach","localParticipant","publishTrack","priority","kind","disconnect","addEventListener","useRoom","onDisconnected","useHandleRoomDisconnectionErrors","useHandleTrackPublicationFailed","useHandleOnDisconnect","useVideoContext","context","Error","useStyles","makeStyles","theme","createStyles","fab","margin","spacing","EndCallButton","classes","Tooltip","title","onClick","placement","PopperProps","disablePortal","Fab","className","color","useLocalAudioToggle","find","isEnabled","setIsEnabled","setEnabled","setDisabled","useIsTrackEnabled","disable","enable","ToggleAudioButton","props","isAudioEnabled","toggleAudioEnabled","disabled","data-cy-audio-toggle","ToggleVideoButton","toggleVideoEnabled","localTrackPublication","unpublishTrack","emit","stop","useLocalVideoToggle","isVideoEnabled","useScreenShareParticipant","screenShareParticipant","setScreenShareParticipant","state","updateScreenShareParticipant","Array","from","participants","values","concat","trackName","backgroundColor","ToggleScreenShareButton","isSharing","setIsSharing","stopScreenShareRef","shareScreen","navigator","mediaDevices","getDisplayMedia","audio","video","stream","getTracks","trackPublication","onended","catch","toggleScreenShare","useScreenShareToggle","isScreenShared","disableScreenShareButton","isScreenShareSupported","isDisabled","tooltipMessage","style","cursor","useRoomState","setState","setRoomState","container","display","position","right","transform","bottom","zIndex","transition","opacity","visibility","Controls","roomState","isReconnecting","showControls","isUserActive","setIsUserActive","timeoutIDRef","handleUserActivity","throttle","clearTimeout","timeoutID","useIsUserActive","clsx","styled","maxHeight","objectFit","VideoTrack","isLocal","ref","el","muted","setPriority","attach","detach","LocalVideoPreview","FullscreenButton","IconButton","marginLeft","ToggleFullscreenButton","fscreen","fullscreenElement","isFullScreen","setIsFullScreen","onFullScreenChange","toggleFullScreen","exitFullscreen","requestFullscreen","document","documentElement","useFullScreenToggle","aria-label","AboutDialog","open","onClose","Dialog","fullWidth","maxWidth","DialogTitle","DialogContent","DialogContentText","String","isSupported","version","appVersion","process","REACT_APP_GIT_TAG","REACT_APP_GIT_COMMIT","DialogActions","Button","autoFocus","red","UserAvatar","user","displayName","photoURL","Avatar","src","split","map","text","join","toUpperCase","firebaseConfig","apiKey","REACT_APP_FIREBASE_API_KEY","authDomain","REACT_APP_FIREBASE_AUTH_DOMAIN","databaseURL","REACT_APP_FIREBASE_DATABASE_URL","storageBucket","REACT_APP_FIREBASE_STORAGE_BUCKET","messagingSenderId","REACT_APP_FIREBASE_MESSAGING_SENDER_ID","fetchToken","passcode","fetch","method","headers","body","JSON","stringify","user_identity","room_name","verifyPasscode","res","a","json","jsonResponse","status","isValid","ok","getErrorMessage","usePasscodeAuth","history","useHistory","setUser","isAuthReady","setIsAuthReady","getToken","errorMessage","statusText","match","location","search","sessionStorage","getItem","getPasscode","verification","setItem","replace","pathname","signIn","signOut","removeItem","Promise","resolve","StateContext","AppStateProvider","setError","isFetching","setIsFetching","contextValue","REACT_APP_SET_AUTH","identity","roomName","Headers","getIdToken","idToken","set","params","URLSearchParams","firebase","onAuthStateChanged","provider","GoogleAuthProvider","addScope","signInWithPopup","useFirebaseAuth","password","err","reject","useAppState","Menu","aboutOpen","setAboutOpen","menuOpen","setMenuOpen","anchorRef","handleSignOut","anchorEl","MenuItem","palette","background","default","form","alignItems","textField","marginRight","loadingSpinner","minWidth","fontWeight","MenuBar","URLRoomName","useParams","setName","setPassword","setRoomName","AppBar","Toolbar","onSubmit","event","preventDefault","origin","includes","replaceState","encodeURI","Typography","variant","TextField","id","label","onChange","target","type","CircularProgress","snackbar","icon","ReconnectingNotification","Snackbar","anchorOrigin","vertical","horizontal","SnackbarContent","BandwidthWarningContainer","flexDirection","justifyContent","Warning","textAlign","BandwidthWarning","fontSize","Container","border","boxSizing","borderRight","NetworkQualityLevel","qualityLevel","level","key","indicator","borderRadius","ParticipantConnectionIndicator","setIsReconnecting","handleReconnecting","handleReconnected","useParticipantIsReconnecting","PinIcon","SvgIcon","float","usePublications","publications","setPublications","publicationAdded","publication","prevPublications","publicationRemoved","p","useIsTrackSwitchedOff","isSwitchedOff","setIsSwitchedOff","handleSwitchedOff","handleSwitchedOn","useTrack","removeTrack","sidebarWidth","overflow","stroke","strokeWidth","isVideoSwitchedOff","infoContainer","padding","hideVideo","infoRow","ParticipantInfo","isSelected","audioPublication","videoPublication","networkQualityLevel","setNetworkQualityLevel","handleNewtorkQualityLevelChange","newNetworkQualityLevel","useParticipantNetworkQualityLevel","isTrackEnabled","usePublicationIsTrackEnabled","Boolean","isScreenShareEnabled","data-cy-participant","data-cy-audio-mute-icon","AudioTrack","Publication","disableAudio","videoPriority","ParticipantTracks","filteredPublications","enableScreenShare","some","Participant","useDominantSpeaker","dominantSpeaker","setDominantSpeaker","handleDominantSpeakerChanged","newDominantSpeaker","handleParticipantDisconnected","prevDominantSpeaker","useParticipants","setParticipants","prevParticipants","participantConnected","participantDisconnected","top","left","overflowY","ParticipantStrip","setSelectedParticipant","sid","MainParticipantInfo","screenSharePublication","data-cy-main-participant","MainParticipant","mainParticipant","useMainSpeaker","MainParticipantContainer","Room","Main","App","ErrorDialog","dismissError","code","enhancedMessage","enhanceMessage","_extends","Object","assign","i","arguments","length","source","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","createElement","_ref3","_ref4","x","y","filterUnits","dx","dy","in","result","stdDeviation","rx","_ref5","fill","fillRule","d","_ref","svgRef","viewBox","ForwardRef","forwardRef","twilioLogo","videoLogo","paper","marginTop","button","textTransform","createMuiTheme","LoginPage","useLocation","setPasscode","authError","setAuthError","isAuthEnabled","login","ThemeProvider","Grid","justify","Paper","elevation","alt","startIcon","e","direction","PrivateRoute","rest","renderChildren","render","to","primary","main","connectionOptions","bandwidthProfile","mode","dominantSpeakerPriority","renderDimensions","high","standard","low","maxAudioBitrate","networkQuality","local","remote","preferredVideoCodecs","codec","simulcast","VideoApp","ReactDOM","CssBaseline","exact","path","getElementById"],"mappings":"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","file":"static/js/main.63cec973.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZIAAAEyCAYAAADQnlYUAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFdElEQVR42u3dwW3DUAxEQSnI2a2oCxXtLtyKGlB68BrZMH+mAoGH/8CLuF/HeW8AC3u8nrspvO/LCAAQEgAqruO8hQSAtyNiIwEgioiQABBFREgAiCIiJABEERESAKKICAkAUUSEBIAoIkICQBQRIQEgioiQABBFREgAiCIiJABEERESAKKICAkAW3rg8PuTH+PKGDDl8eNzc7SRAIiIkADQ2+iEBEBEhASATkSEBEBEhASAXkSEBEBEhASAXkSEBEBEhASAXkSEBEBEhASAXkSEBEBEhASA7t+QhQRARIQEQESEBICBERESABEREgARERIAhkZESABEREgARERIABgaESEBEBEhARARIQFgaESEBEBEhARARIQEgKERERKARSPyeD13IQEQkXpEhARARIQEQER6ERESABEREgAR6UVESABEREgARKQXESEBEBEhARCRXkSEBEBEhARARHoRERIAERESABHpRURIAERESABEREgARGRoRIQEQESEBEBEhARARIZGREgARERIAERESABEZGhEhARARIQEQESEBEBEhkZESABEREgARERIAERkaESEBEBEhARARIQEQESEBEBEVoyIkACIiJAATPLfIiIkACIiJAAiIiQAIiIkAKwYESEBEBEhARARIQEQESEBYMWICAmAiAgJgIgICYCICAmAiAgJACIiJAAiIiQAIiIkACIiJACIiJAAiIiQAIiIkACIiJAAiAhCAiAiQgIgIkICICJCAiAiCAmAiAgJgIgICYCICAmAiAgJgIggJAAiIiQAIiIkACIiJAAigpAAiIiQAIiIkACIiJAAiAhCAogIQgIgIkICICJCAiAiCAkgIggJgIj8Fd9GAAgINhIAhAQAIQFASABASAAQEgCEBAAhAQAhAUBIABASAIQEAIQEACEBQEgAEBIAEBIAhAQAIQFASAAQEgAQEgCEBAAhAUBIAEBIABASAIQEACEBACEBQEgAEBIAhAQAhAQAIQFASAAQEgCEBACEBAAhAUBIABASABASAIQEACEBQEgAQEgAEBIAhAQAIQEAIQFASAAQEoDQdZz3dZy3SQgJQBwUUxASADEREgAxERIAMUFIADEREyEBEBMhARATIQEQE4QEQEyEBEBMhARATIQEQEwQEgAxERIAMRESADEREgAxQUgAxERIAMRESADEREgAxERIABATIQEQEyEBEBMhARATIQFATIQEQEyEBEBMhARATIQEADEREgAxERIAMRESADEREgDEREgAxERIAMRESADEREgAWDsmQgIgJkICICZCAiAmQgLAijEREgAxERIAMRESADEREgBWjImQAGzb9ng9dzEREgAxERIAMRESADFZKiZCAiAmQgIgJkICICZDYyIkAGIiJABiIiQAYjI0JkICICZCAiAmQgIgJkNjIiQAYiIkAGIiJABiMjQmQgIgJkICICZCAiAmQ2MiJABiIiQAYtKLiZAAiImQAIhJLyZCAiAmQgIgJr2YCAmAmAgJgJj0YiIkAGIiJABi0ouJkACIiZAAiEkvJkICICZCAiAmvZgICcCiMRESADEREgDmx0RIAMRESADEREgAGBoTIQEQEyEBEBMhAWBoTIQEQEyEBEBMhASAoTEREgAxERIAMRESAIbGREgAxERIAOjFREgAxERIAOjFREgAxERIAOjFREgAxERIAOjFREgAxERIAOjFREgAxERIAOjFREgAxERIAOjFZL+O8zZOwKP6926h/5a0AzYSABGNIiokAEQxERIAopgICQBRTIQEgCgmQgJAFBMhASCKiZAAEMVESACIYiIkAEQxERIAopgICQBRTIQEgCgmQgJAFBMhASCKiZAAEMVESACI/ACDMI238rqCJQAAAABJRU5ErkJggg==\"","import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { Participant, Room } from 'twilio-video';\r\n\r\ntype selectedParticipantContextType = [Participant | null, (participant: Participant) => void];\r\n\r\nexport const selectedParticipantContext = createContext<selectedParticipantContextType>(null!);\r\n\r\nexport default function useSelectedParticipant() {\r\n  const [selectedParticipant, setSelectedParticipant] = useContext(selectedParticipantContext);\r\n  return [selectedParticipant, setSelectedParticipant] as const;\r\n}\r\n\r\ntype SelectedParticipantProviderProps = {\r\n  room: Room;\r\n  children: React.ReactNode;\r\n};\r\n\r\nexport function SelectedParticipantProvider({ room, children }: SelectedParticipantProviderProps) {\r\n  const [selectedParticipant, _setSelectedParticipant] = useState<Participant | null>(null);\r\n  const setSelectedParticipant = (participant: Participant) =>\r\n    _setSelectedParticipant(prevParticipant => (prevParticipant === participant ? null : participant));\r\n\r\n  useEffect(() => {\r\n    const onDisconnect = () => _setSelectedParticipant(null);\r\n    room.on('disconnected', onDisconnect);\r\n    return () => {\r\n      room.off('disconnected', onDisconnect);\r\n    };\r\n  }, [room]);\r\n\r\n  return (\r\n    <selectedParticipantContext.Provider value={[selectedParticipant, setSelectedParticipant]}>\r\n      {children}\r\n    </selectedParticipantContext.Provider>\r\n  );\r\n}\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport Video, { LocalVideoTrack, LocalAudioTrack } from 'twilio-video';\r\n\r\nexport function useLocalAudioTrack() {\r\n  const [track, setTrack] = useState<LocalAudioTrack>();\r\n\r\n  useEffect(() => {\r\n    Video.createLocalAudioTrack().then(newTrack => {\r\n      setTrack(newTrack);\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const handleStopped = () => setTrack(undefined);\r\n    if (track) {\r\n      track.on('stopped', handleStopped);\r\n      return () => {\r\n        track.off('stopped', handleStopped);\r\n      };\r\n    }\r\n  }, [track]);\r\n\r\n  return track;\r\n}\r\n\r\nexport function useLocalVideoTrack() {\r\n  const [track, setTrack] = useState<LocalVideoTrack>();\r\n\r\n  const getLocalVideoTrack = useCallback(\r\n    () =>\r\n      Video.createLocalVideoTrack({\r\n        frameRate: 24,\r\n        height: 720,\r\n        width: 1280,\r\n        name: 'camera',\r\n      }).then(newTrack => {\r\n        setTrack(newTrack);\r\n        return newTrack;\r\n      }),\r\n    []\r\n  );\r\n\r\n  useEffect(() => {\r\n    // We get a new local video track when the app loads.\r\n    getLocalVideoTrack();\r\n  }, [getLocalVideoTrack]);\r\n\r\n  useEffect(() => {\r\n    const handleStopped = () => setTrack(undefined);\r\n    if (track) {\r\n      track.on('stopped', handleStopped);\r\n      return () => {\r\n        track.off('stopped', handleStopped);\r\n      };\r\n    }\r\n  }, [track]);\r\n\r\n  return [track, getLocalVideoTrack] as const;\r\n}\r\n\r\nexport default function useLocalTracks() {\r\n  const audioTrack = useLocalAudioTrack();\r\n  const [videoTrack, getLocalVideoTrack] = useLocalVideoTrack();\r\n\r\n  const localTracks = [audioTrack, videoTrack].filter(track => track !== undefined) as (\r\n    | LocalAudioTrack\r\n    | LocalVideoTrack\r\n  )[];\r\n\r\n  return { localTracks, getLocalVideoTrack };\r\n}\r\n","import React, { createContext, ReactNode } from 'react';\r\nimport { ConnectOptions, Room, TwilioError, LocalAudioTrack, LocalVideoTrack } from 'twilio-video';\r\nimport { Callback, ErrorCallback } from '../../types';\r\nimport { SelectedParticipantProvider } from './useSelectedParticipant/useSelectedParticipant';\r\n\r\nimport useHandleRoomDisconnectionErrors from './useHandleRoomDisconnectionErrors/useHandleRoomDisconnectionErrors';\r\nimport useHandleOnDisconnect from './useHandleOnDisconnect/useHandleOnDisconnect';\r\nimport useHandleTrackPublicationFailed from './useHandleTrackPublicationFailed/useHandleTrackPublicationFailed';\r\nimport useLocalTracks from './useLocalTracks/useLocalTracks';\r\nimport useRoom from './useRoom/useRoom';\r\n\r\n/*\r\n *  The hooks used by the VideoProvider component are different than the hooks found in the 'hooks/' directory. The hooks\r\n *  in the 'hooks/' directory can be used anywhere in a video application, and they can be used any number of times.\r\n *  the hooks in the 'VideoProvider/' directory are intended to be used by the VideoProvider component only. Using these hooks\r\n *  elsewhere in the application may cause problems as these hooks should not be used more than once in an application.\r\n */\r\n\r\nexport interface IVideoContext {\r\n  room: Room;\r\n  localTracks: (LocalAudioTrack | LocalVideoTrack)[];\r\n  isConnecting: boolean;\r\n  connect: (token: string) => Promise<void>;\r\n  onError: ErrorCallback;\r\n  onDisconnect: Callback;\r\n  getLocalVideoTrack: () => Promise<LocalVideoTrack>;\r\n}\r\n\r\nexport const VideoContext = createContext<IVideoContext>(null!);\r\n\r\ninterface VideoProviderProps {\r\n  options?: ConnectOptions;\r\n  onError: ErrorCallback;\r\n  onDisconnect?: Callback;\r\n  children: ReactNode;\r\n}\r\n\r\nexport function VideoProvider({ options, children, onError = () => {}, onDisconnect = () => {} }: VideoProviderProps) {\r\n  const onErrorCallback = (error: TwilioError) => {\r\n    console.log(`ERROR: ${error.message}`, error);\r\n    onError(error);\r\n  };\r\n\r\n  const { localTracks, getLocalVideoTrack } = useLocalTracks();\r\n  const { room, isConnecting, connect } = useRoom(localTracks, onErrorCallback, options);\r\n\r\n  // Register onError and onDisconnect callback functions.\r\n  useHandleRoomDisconnectionErrors(room, onError);\r\n  useHandleTrackPublicationFailed(room, onError);\r\n  useHandleOnDisconnect(room, onDisconnect);\r\n\r\n  return (\r\n    <VideoContext.Provider\r\n      value={{\r\n        room,\r\n        localTracks,\r\n        isConnecting,\r\n        onError: onErrorCallback,\r\n        onDisconnect,\r\n        getLocalVideoTrack,\r\n        connect,\r\n      }}\r\n    >\r\n      <SelectedParticipantProvider room={room}>{children}</SelectedParticipantProvider>\r\n    </VideoContext.Provider>\r\n  );\r\n}\r\n","import EventEmitter from 'events';\r\nimport { useCallback, useEffect, useRef, useState } from 'react';\r\nimport Video, { ConnectOptions, LocalTrack, Room } from 'twilio-video';\r\nimport { Callback } from '../../../types';\r\n\r\nexport default function useRoom(localTracks: LocalTrack[], onError: Callback, options?: ConnectOptions) {\r\n  const [room, setRoom] = useState<Room>(new EventEmitter() as Room);\r\n  const [isConnecting, setIsConnecting] = useState(false);\r\n  const disconnectHandlerRef = useRef<() => void>(() => {});\r\n  const localTracksRef = useRef<LocalTrack[]>([]);\r\n\r\n  useEffect(() => {\r\n    // It can take a moment for Video.connect to connect to a room. During this time, the user may have enabled or disabled their\r\n    // local audio or video tracks. If this happens, we store the localTracks in this ref, so that they are correctly published\r\n    // once the user is connected to the room.\r\n    localTracksRef.current = localTracks;\r\n  }, [localTracks]);\r\n\r\n  const connect = useCallback(\r\n    token => {\r\n      setIsConnecting(true);\r\n      return Video.connect(token, { ...options, tracks: [] }).then(\r\n        newRoom => {\r\n          setRoom(newRoom);\r\n\r\n          newRoom.once('disconnected', () => {\r\n            // Reset the room only after all other `disconnected` listeners have been called.\r\n            setTimeout(() => setRoom(new EventEmitter() as Room));\r\n            window.removeEventListener('beforeunload', disconnectHandlerRef.current);\r\n          });\r\n\r\n          // @ts-ignore\r\n          window.twilioRoom = newRoom;\r\n\r\n          localTracksRef.current.forEach(track =>\r\n            // Tracks can be supplied as arguments to the Video.connect() function and they will automatically be published.\r\n            // However, tracks must be published manually in order to set the priority on them.\r\n            // All video tracks are published with 'low' priority. This works because the video\r\n            // track that is displayed in the 'MainParticipant' component will have it's priority\r\n            // set to 'high' via track.setPriority()\r\n            newRoom.localParticipant.publishTrack(track, { priority: track.kind === 'video' ? 'low' : 'standard' })\r\n          );\r\n\r\n          disconnectHandlerRef.current = () => newRoom.disconnect();\r\n          setIsConnecting(false);\r\n\r\n          // Add a listener to disconnect from the room when a user closes their browser\r\n          window.addEventListener('beforeunload', disconnectHandlerRef.current);\r\n        },\r\n        error => {\r\n          onError(error);\r\n          setIsConnecting(false);\r\n        }\r\n      );\r\n    },\r\n    [options, onError]\r\n  );\r\n\r\n  return { room, isConnecting, connect };\r\n}\r\n","import { Room, TwilioError } from 'twilio-video';\r\nimport { useEffect } from 'react';\r\n\r\nimport { Callback } from '../../../types';\r\n\r\nexport default function useHandleRoomDisconnectionErrors(room: Room, onError: Callback) {\r\n  useEffect(() => {\r\n    const onDisconnected = (room: Room, error: TwilioError) => {\r\n      if (error) {\r\n        onError(error);\r\n      }\r\n    };\r\n\r\n    room.on('disconnected', onDisconnected);\r\n    return () => {\r\n      room.off('disconnected', onDisconnected);\r\n    };\r\n  }, [room, onError]);\r\n}\r\n","import { Room } from 'twilio-video';\r\nimport { useEffect } from 'react';\r\n\r\nimport { Callback } from '../../../types';\r\n\r\nexport default function useHandleTrackPublicationFailed(room: Room, onError: Callback) {\r\n  const { localParticipant } = room;\r\n  useEffect(() => {\r\n    if (localParticipant) {\r\n      localParticipant.on('trackPublicationFailed', onError);\r\n      return () => {\r\n        localParticipant.off('trackPublicationFailed', onError);\r\n      };\r\n    }\r\n  }, [localParticipant, onError]);\r\n}\r\n","import { useEffect } from 'react';\r\nimport { Room } from 'twilio-video';\r\nimport { Callback } from '../../../types';\r\n\r\nexport default function useHandleOnDisconnect(room: Room, onDisconnect: Callback) {\r\n  useEffect(() => {\r\n    room.on('disconnected', onDisconnect);\r\n    return () => {\r\n      room.off('disconnected', onDisconnect);\r\n    };\r\n  }, [room, onDisconnect]);\r\n}\r\n","import { useContext } from 'react';\r\nimport { VideoContext } from '../../components/VideoProvider';\r\n\r\nexport default function useVideoContext() {\r\n  const context = useContext(VideoContext);\r\n  if (!context) {\r\n    throw new Error('useVideoContext must be used within a VideoProvider');\r\n  }\r\n  return context;\r\n}\r\n","import React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport CallEnd from '@material-ui/icons/CallEnd';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    fab: {\r\n      margin: theme.spacing(1),\r\n    },\r\n  })\r\n);\r\n\r\nexport default function EndCallButton() {\r\n  const classes = useStyles();\r\n  const { room } = useVideoContext();\r\n\r\n  return (\r\n    <Tooltip title={'End Call'} onClick={() => room.disconnect()} placement=\"top\" PopperProps={{ disablePortal: true }}>\r\n      <Fab className={classes.fab} color=\"primary\">\r\n        <CallEnd />\r\n      </Fab>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { LocalAudioTrack } from 'twilio-video';\r\nimport { useCallback } from 'react';\r\nimport useIsTrackEnabled from '../useIsTrackEnabled/useIsTrackEnabled';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\nexport default function useLocalAudioToggle() {\r\n  const { localTracks } = useVideoContext();\r\n  const audioTrack = localTracks.find(track => track.kind === 'audio') as LocalAudioTrack;\r\n  const isEnabled = useIsTrackEnabled(audioTrack);\r\n\r\n  const toggleAudioEnabled = useCallback(() => {\r\n    if (audioTrack) {\r\n      audioTrack.isEnabled ? audioTrack.disable() : audioTrack.enable();\r\n    }\r\n  }, [audioTrack]);\r\n\r\n  return [isEnabled, toggleAudioEnabled] as const;\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { LocalAudioTrack, LocalVideoTrack, RemoteAudioTrack, RemoteVideoTrack } from 'twilio-video';\r\n\r\ntype TrackType = LocalAudioTrack | LocalVideoTrack | RemoteAudioTrack | RemoteVideoTrack | undefined;\r\n\r\nexport default function useIsTrackEnabled(track: TrackType) {\r\n  const [isEnabled, setIsEnabled] = useState(track ? track.isEnabled : true);\r\n\r\n  useEffect(() => {\r\n    setIsEnabled(track ? track.isEnabled : true);\r\n\r\n    if (track) {\r\n      const setEnabled = () => setIsEnabled(true);\r\n      const setDisabled = () => setIsEnabled(false);\r\n      track.on('enabled', setEnabled);\r\n      track.on('disabled', setDisabled);\r\n      return () => {\r\n        track.off('enabled', setEnabled);\r\n        track.off('disabled', setDisabled);\r\n      };\r\n    }\r\n  }, [track]);\r\n\r\n  return isEnabled;\r\n}\r\n","import React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Mic from '@material-ui/icons/Mic';\r\nimport MicOff from '@material-ui/icons/MicOff';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport useLocalAudioToggle from '../../../hooks/useLocalAudioToggle/useLocalAudioToggle';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    fab: {\r\n      margin: theme.spacing(1),\r\n    },\r\n  })\r\n);\r\n\r\nexport default function ToggleAudioButton(props: { disabled?: boolean }) {\r\n  const classes = useStyles();\r\n  const [isAudioEnabled, toggleAudioEnabled] = useLocalAudioToggle();\r\n\r\n  return (\r\n    <Tooltip\r\n      title={isAudioEnabled ? 'Mute Audio' : 'Unmute Audio'}\r\n      placement=\"top\"\r\n      PopperProps={{ disablePortal: true }}\r\n    >\r\n      <Fab className={classes.fab} onClick={toggleAudioEnabled} disabled={props.disabled} data-cy-audio-toggle>\r\n        {isAudioEnabled ? <Mic /> : <MicOff />}\r\n      </Fab>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Videocam from '@material-ui/icons/Videocam';\r\nimport VideocamOff from '@material-ui/icons/VideocamOff';\r\n\r\nimport useLocalVideoToggle from '../../../hooks/useLocalVideoToggle/useLocalVideoToggle';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    fab: {\r\n      margin: theme.spacing(1),\r\n    },\r\n  })\r\n);\r\n\r\nexport default function ToggleVideoButton(props: { disabled?: boolean }) {\r\n  const classes = useStyles();\r\n  const [isVideoEnabled, toggleVideoEnabled] = useLocalVideoToggle();\r\n\r\n  return (\r\n    <Tooltip\r\n      title={isVideoEnabled ? 'Mute Video' : 'Unmute Video'}\r\n      placement=\"top\"\r\n      PopperProps={{ disablePortal: true }}\r\n    >\r\n      <Fab className={classes.fab} onClick={toggleVideoEnabled} disabled={props.disabled}>\r\n        {isVideoEnabled ? <Videocam /> : <VideocamOff />}\r\n      </Fab>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { LocalVideoTrack } from 'twilio-video';\r\nimport { useCallback } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\nexport default function useLocalVideoToggle() {\r\n  const {\r\n    room: { localParticipant },\r\n    localTracks,\r\n    getLocalVideoTrack,\r\n  } = useVideoContext();\r\n  const videoTrack = localTracks.find(track => track.name === 'camera') as LocalVideoTrack;\r\n\r\n  const toggleVideoEnabled = useCallback(() => {\r\n    if (videoTrack) {\r\n      if (localParticipant) {\r\n        const localTrackPublication = localParticipant.unpublishTrack(videoTrack);\r\n        // TODO: remove when SDK implements this event. See: https://issues.corp.twilio.com/browse/JSDK-2592\r\n        localParticipant.emit('trackUnpublished', localTrackPublication);\r\n      }\r\n      videoTrack.stop();\r\n    } else {\r\n      getLocalVideoTrack().then((track: LocalVideoTrack) => {\r\n        if (localParticipant) {\r\n          localParticipant.publishTrack(track);\r\n        }\r\n      });\r\n    }\r\n  }, [videoTrack, localParticipant, getLocalVideoTrack]);\r\n\r\n  return [!!videoTrack, toggleVideoEnabled] as const;\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\nimport { Participant, TrackPublication } from 'twilio-video';\r\n\r\n/*\r\n  Returns the participant that is sharing their screen (if any). This hook assumes that only one participant\r\n  can share their screen at a time.\r\n*/\r\nexport default function useScreenShareParticipant() {\r\n  const { room } = useVideoContext();\r\n  const [screenShareParticipant, setScreenShareParticipant] = useState();\r\n\r\n  useEffect(() => {\r\n    if (room.state === 'connected') {\r\n      const updateScreenShareParticipant = () => {\r\n        setScreenShareParticipant(\r\n          // @ts-ignore\r\n          Array.from<Participant>(room.participants.values())\r\n            // the screenshare participant could be the localParticipant\r\n            .concat(room.localParticipant)\r\n            .find((participant: Participant) =>\r\n              Array.from<TrackPublication>(participant.tracks.values()).find(track => track.trackName === 'screen')\r\n            )\r\n        );\r\n      };\r\n      updateScreenShareParticipant();\r\n\r\n      room.on('trackPublished', updateScreenShareParticipant);\r\n      room.on('trackUnpublished', updateScreenShareParticipant);\r\n      room.on('participantDisconnected', updateScreenShareParticipant);\r\n\r\n      // the room object does not emit 'trackPublished' events for the localParticipant,\r\n      // so we need to listen for them here.\r\n      room.localParticipant.on('trackPublished', updateScreenShareParticipant);\r\n      room.localParticipant.on('trackUnpublished', updateScreenShareParticipant);\r\n      return () => {\r\n        room.off('trackPublished', updateScreenShareParticipant);\r\n        room.off('trackUnpublished', updateScreenShareParticipant);\r\n        room.off('participantDisconnected', updateScreenShareParticipant);\r\n\r\n        room.localParticipant.off('trackPublished', updateScreenShareParticipant);\r\n        room.localParticipant.off('trackUnpublished', updateScreenShareParticipant);\r\n      };\r\n    }\r\n  }, [room]);\r\n\r\n  return screenShareParticipant;\r\n}\r\n","import React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport Fab from '@material-ui/core/Fab';\r\nimport ScreenShare from '@material-ui/icons/ScreenShare';\r\nimport StopScreenShare from '@material-ui/icons/StopScreenShare';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport useScreenShareToggle from '../../../hooks/useScreenShareToggle/useScreenShareToggle';\r\nimport useScreenShareParticipant from '../../../hooks/useScreenShareParticipant/useScreenShareParticipant';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport const SCREEN_SHARE_TEXT = 'Share Screen';\r\nexport const STOP_SCREEN_SHARE_TEXT = 'Stop Sharing Screen';\r\nexport const SHARE_IN_PROGRESS_TEXT = 'Cannot share screen when another user is sharing';\r\nexport const SHARE_NOT_SUPPORTED_TEXT = 'Screen sharing is not supported with this browser';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    fab: {\r\n      margin: theme.spacing(1),\r\n      '&[disabled]': {\r\n        color: 'rgba(225, 225, 225, 0.8)',\r\n        backgroundColor: 'rgba(175, 175, 175, 0.6);',\r\n      },\r\n    },\r\n  })\r\n);\r\n\r\nexport default function ToggleScreenShareButton(props: { disabled?: boolean }) {\r\n  const classes = useStyles();\r\n  const [isScreenShared, toggleScreenShare] = useScreenShareToggle();\r\n  const screenShareParticipant = useScreenShareParticipant();\r\n  const { room } = useVideoContext();\r\n  const disableScreenShareButton = screenShareParticipant && screenShareParticipant !== room.localParticipant;\r\n  const isScreenShareSupported = navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia;\r\n  const isDisabled = props.disabled || disableScreenShareButton || !isScreenShareSupported;\r\n\r\n  let tooltipMessage = SCREEN_SHARE_TEXT;\r\n\r\n  if (isScreenShared) {\r\n    tooltipMessage = STOP_SCREEN_SHARE_TEXT;\r\n  }\r\n\r\n  if (disableScreenShareButton) {\r\n    tooltipMessage = SHARE_IN_PROGRESS_TEXT;\r\n  }\r\n\r\n  if (!isScreenShareSupported) {\r\n    tooltipMessage = SHARE_NOT_SUPPORTED_TEXT;\r\n  }\r\n\r\n  return (\r\n    <Tooltip\r\n      title={tooltipMessage}\r\n      placement=\"top\"\r\n      PopperProps={{ disablePortal: true }}\r\n      style={{ cursor: isDisabled ? 'not-allowed' : 'pointer' }}\r\n    >\r\n      <div>\r\n        {/* The div element is needed because a disabled button will not emit hover events and we want to display\r\n          a tooltip when screen sharing is disabled */}\r\n        <Fab className={classes.fab} onClick={toggleScreenShare} disabled={isDisabled}>\r\n          {isScreenShared ? <StopScreenShare /> : <ScreenShare />}\r\n        </Fab>\r\n      </div>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { useState, useCallback, useRef } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\nimport { LogLevels, Track } from 'twilio-video';\r\n\r\ninterface MediaStreamTrackPublishOptions {\r\n  name?: string;\r\n  priority: Track.Priority;\r\n  logLevel: LogLevels;\r\n}\r\n\r\nexport default function useScreenShareToggle() {\r\n  const { room, onError } = useVideoContext();\r\n  const [isSharing, setIsSharing] = useState(false);\r\n  const stopScreenShareRef = useRef<() => void>(null!);\r\n\r\n  const shareScreen = useCallback(() => {\r\n    navigator.mediaDevices\r\n      .getDisplayMedia({\r\n        audio: false,\r\n        video: {\r\n          frameRate: 10,\r\n          height: 1080,\r\n          width: 1920,\r\n        },\r\n      })\r\n      .then(stream => {\r\n        const track = stream.getTracks()[0];\r\n\r\n        // All video tracks are published with 'low' priority. This works because the video\r\n        // track that is displayed in the 'MainParticipant' component will have it's priority\r\n        // set to 'high' via track.setPriority()\r\n        room.localParticipant\r\n          .publishTrack(track, {\r\n            name: 'screen', // Tracks can be named to easily find them later\r\n            priority: 'low', // Priority is set to high by the subscriber when the video track is rendered\r\n          } as MediaStreamTrackPublishOptions)\r\n          .then(trackPublication => {\r\n            stopScreenShareRef.current = () => {\r\n              room.localParticipant.unpublishTrack(track);\r\n              // TODO: remove this if the SDK is updated to emit this event\r\n              room.localParticipant.emit('trackUnpublished', trackPublication);\r\n              track.stop();\r\n              setIsSharing(false);\r\n            };\r\n\r\n            track.onended = stopScreenShareRef.current;\r\n            setIsSharing(true);\r\n          })\r\n          .catch(onError);\r\n      })\r\n      .catch(error => {\r\n        // Don't display an error if the user closes the screen share dialog\r\n        if (error.name !== 'AbortError' && error.name !== 'NotAllowedError') {\r\n          onError(error);\r\n        }\r\n      });\r\n  }, [room, onError]);\r\n\r\n  const toggleScreenShare = useCallback(() => {\r\n    !isSharing ? shareScreen() : stopScreenShareRef.current();\r\n  }, [isSharing, shareScreen, stopScreenShareRef]);\r\n\r\n  return [isSharing, toggleScreenShare] as const;\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\ntype RoomStateType = 'disconnected' | 'connected' | 'reconnecting';\r\n\r\nexport default function useRoomState() {\r\n  const { room } = useVideoContext();\r\n  const [state, setState] = useState<RoomStateType>('disconnected');\r\n\r\n  useEffect(() => {\r\n    const setRoomState = () => setState((room.state || 'disconnected') as RoomStateType);\r\n    setRoomState();\r\n    room\r\n      .on('disconnected', setRoomState)\r\n      .on('reconnected', setRoomState)\r\n      .on('reconnecting', setRoomState);\r\n    return () => {\r\n      room\r\n        .off('disconnected', setRoomState)\r\n        .off('reconnected', setRoomState)\r\n        .off('reconnecting', setRoomState);\r\n    };\r\n  }, [room]);\r\n\r\n  return state;\r\n}\r\n","import React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\nimport clsx from 'clsx';\r\n\r\nimport EndCallButton from './EndCallButton/EndCallButton';\r\nimport ToggleAudioButton from './ToggleAudioButton/ToggleAudioButton';\r\nimport ToggleVideoButton from './ToggleVideoButton/ToggleVideoButton';\r\nimport ToggleScreenShareButton from './ToogleScreenShareButton/ToggleScreenShareButton';\r\n\r\nimport useIsUserActive from './useIsUserActive/useIsUserActive';\r\nimport useRoomState from '../../hooks/useRoomState/useRoomState';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    container: {\r\n      display: 'flex',\r\n      position: 'absolute',\r\n      right: '50%',\r\n      transform: 'translate(50%, 30px)',\r\n      bottom: '50px',\r\n      zIndex: 1,\r\n      transition: 'opacity 1.2s, transform 1.2s, visibility 0s 1.2s',\r\n      opacity: 0,\r\n      visibility: 'hidden',\r\n      '&.showControls, &:hover': {\r\n        transition: 'opacity 0.6s, transform 0.6s, visibility 0s',\r\n        opacity: 1,\r\n        visibility: 'visible',\r\n        transform: 'translate(50%, 0px)',\r\n      },\r\n    },\r\n  })\r\n);\r\n\r\nexport default function Controls() {\r\n  const classes = useStyles();\r\n  const roomState = useRoomState();\r\n  const isReconnecting = roomState === 'reconnecting';\r\n  const isUserActive = useIsUserActive();\r\n  const showControls = isUserActive || roomState === 'disconnected';\r\n\r\n  return (\r\n    <div className={clsx(classes.container, { showControls })}>\r\n      <ToggleAudioButton disabled={isReconnecting} />\r\n      <ToggleVideoButton disabled={isReconnecting} />\r\n      {roomState !== 'disconnected' && (\r\n        <>\r\n          <ToggleScreenShareButton disabled={isReconnecting} />\r\n          <EndCallButton />\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import { useEffect, useRef, useState } from 'react';\r\nimport throttle from 'lodash.throttle';\r\n\r\nexport default function useIsUserActive() {\r\n  const [isUserActive, setIsUserActive] = useState(true);\r\n  const timeoutIDRef = useRef(0);\r\n\r\n  useEffect(() => {\r\n    const handleUserActivity = throttle(() => {\r\n      setIsUserActive(true);\r\n      clearTimeout(timeoutIDRef.current);\r\n      const timeoutID = window.setTimeout(() => setIsUserActive(false), 5000);\r\n      timeoutIDRef.current = timeoutID;\r\n    }, 500);\r\n\r\n    handleUserActivity();\r\n\r\n    window.addEventListener('mousemove', handleUserActivity);\r\n    window.addEventListener('click', handleUserActivity);\r\n    window.addEventListener('keydown', handleUserActivity);\r\n    return () => {\r\n      window.removeEventListener('mousemove', handleUserActivity);\r\n      window.removeEventListener('click', handleUserActivity);\r\n      window.removeEventListener('keydown', handleUserActivity);\r\n      clearTimeout(timeoutIDRef.current);\r\n    };\r\n  }, []);\r\n\r\n  return isUserActive;\r\n}\r\n","import React, { useRef, useEffect } from 'react';\r\nimport { IVideoTrack } from '../../types';\r\nimport { styled } from '@material-ui/core/styles';\r\nimport { Track } from 'twilio-video';\r\n\r\nconst Video = styled('video')({\r\n  width: '100%',\r\n  maxHeight: '100%',\r\n  objectFit: 'contain',\r\n});\r\n\r\ninterface VideoTrackProps {\r\n  track: IVideoTrack;\r\n  isLocal?: boolean;\r\n  priority?: Track.Priority | null;\r\n}\r\n\r\nexport default function VideoTrack({ track, isLocal, priority }: VideoTrackProps) {\r\n  const ref = useRef<HTMLVideoElement>(null!);\r\n\r\n  useEffect(() => {\r\n    const el = ref.current;\r\n    el.muted = true;\r\n    if (track.setPriority && priority) {\r\n      track.setPriority(priority);\r\n    }\r\n    track.attach(el);\r\n    return () => {\r\n      track.detach(el);\r\n      if (track.setPriority && priority) {\r\n        // Passing `null` to setPriority will set the track's priority to that which it was published with.\r\n        track.setPriority(null);\r\n      }\r\n    };\r\n  }, [track, priority]);\r\n\r\n  // The local video track is mirrored.\r\n  const style = isLocal ? { transform: 'rotateY(180deg)' } : {};\r\n\r\n  return <Video ref={ref} style={style} />;\r\n}\r\n","import React from 'react';\r\nimport { LocalVideoTrack } from 'twilio-video';\r\nimport VideoTrack from '../VideoTrack/VideoTrack';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport default function LocalVideoPreview() {\r\n  const { localTracks } = useVideoContext();\r\n\r\n  const videoTrack = localTracks.find(track => track.name === 'camera') as LocalVideoTrack;\r\n\r\n  return videoTrack ? <VideoTrack track={videoTrack} isLocal /> : null;\r\n}\r\n","import React from 'react';\r\nimport { styled } from '@material-ui/core/styles';\r\n\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport useFullScreenToggle from '../../hooks/useFullScreenToggle/useFullScreenToggle';\r\n\r\nconst FullscreenButton = styled(IconButton)({\r\n  marginLeft: 'auto',\r\n});\r\n\r\nexport default function ToggleFullscreenButton() {\r\n  const [isFullScreen, toggleFullScreen] = useFullScreenToggle();\r\n\r\n  return (\r\n    <FullscreenButton aria-label={`full screen`} onClick={toggleFullScreen}>\r\n      {isFullScreen ? <FullscreenExitIcon /> : <FullscreenIcon />}\r\n    </FullscreenButton>\r\n  );\r\n}\r\n","import { useCallback, useState, useEffect } from 'react';\r\nimport fscreen from 'fscreen';\r\n\r\nexport default function useFullScreenToggle() {\r\n  const [isFullScreen, setIsFullScreen] = useState<Boolean>(!!fscreen.fullscreenElement);\r\n\r\n  useEffect(() => {\r\n    const onFullScreenChange = () => setIsFullScreen(!!fscreen.fullscreenElement);\r\n    fscreen.addEventListener('fullscreenchange', onFullScreenChange);\r\n    return () => {\r\n      fscreen.removeEventListener('fullscreenchange', onFullScreenChange);\r\n    };\r\n  }, []);\r\n\r\n  const toggleFullScreen = useCallback(() => {\r\n    isFullScreen ? fscreen.exitFullscreen() : fscreen.requestFullscreen(document.documentElement);\r\n  }, [isFullScreen]);\r\n\r\n  return [isFullScreen, toggleFullScreen] as const;\r\n}\r\n","import React, { PropsWithChildren } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\n\r\nimport { version as appVersion } from '../../../../package.json';\r\nimport Video from 'twilio-video';\r\n\r\ninterface AboutDialogProps {\r\n  open: boolean;\r\n  onClose(): void;\r\n}\r\n\r\nfunction AboutDialog({ open, onClose }: PropsWithChildren<AboutDialogProps>) {\r\n  return (\r\n    <Dialog open={open} onClose={onClose} fullWidth={true} maxWidth=\"xs\">\r\n      <DialogTitle>About:</DialogTitle>\r\n      <DialogContent>\r\n        <DialogContentText>Browser supported: {String(Video.isSupported)}</DialogContentText>\r\n        <DialogContentText>SDK Version: {Video.version}</DialogContentText>\r\n        <DialogContentText>App Version: {appVersion}</DialogContentText>\r\n        <DialogContentText>Deployed Tag: {process.env.REACT_APP_GIT_TAG || 'N/A'}</DialogContentText>\r\n        <DialogContentText>Deployed Commit Hash: {process.env.REACT_APP_GIT_COMMIT || 'N/A'}</DialogContentText>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onClose} color=\"primary\" autoFocus>\r\n          OK\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default AboutDialog;\r\n","import React from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport makeStyles from '@material-ui/styles/makeStyles';\r\nimport Person from '@material-ui/icons/Person';\r\nimport { StateContextType } from '../../../state';\r\n\r\nconst useStyles = makeStyles({\r\n  red: {\r\n    color: 'white',\r\n    backgroundColor: '#F22F46',\r\n  },\r\n});\r\n\r\nexport function getInitials(name: string) {\r\n  return name\r\n    .split(' ')\r\n    .map(text => text[0])\r\n    .join('')\r\n    .toUpperCase();\r\n}\r\n\r\nexport default function UserAvatar({ user }: { user: StateContextType['user'] }) {\r\n  const classes = useStyles();\r\n  const { displayName, photoURL } = user!;\r\n\r\n  return photoURL ? (\r\n    <Avatar src={photoURL} />\r\n  ) : (\r\n    <Avatar className={classes.red}>{displayName ? getInitials(displayName) : <Person />}</Avatar>\r\n  );\r\n}\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport * as firebase from 'firebase/app';\r\nimport 'firebase/auth';\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\r\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\r\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\r\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\r\n};\r\n\r\nexport default function useFirebaseAuth() {\r\n  const [user, setUser] = useState<firebase.User | null>(null);\r\n  const [isAuthReady, setIsAuthReady] = useState(false);\r\n\r\n  const getToken = useCallback(\r\n    async (identity: string, roomName: string) => {\r\n      const headers = new window.Headers();\r\n\r\n      const idToken = await user!.getIdToken();\r\n      headers.set('Authorization', idToken);\r\n\r\n      const endpoint = process.env.REACT_APP_TOKEN_ENDPOINT || '/token';\r\n      const params = new window.URLSearchParams({ identity, roomName });\r\n\r\n      return fetch(`${endpoint}?${params}`, { headers }).then(res => res.text());\r\n    },\r\n    [user]\r\n  );\r\n\r\n  useEffect(() => {\r\n    firebase.initializeApp(firebaseConfig);\r\n    firebase.auth().onAuthStateChanged(user => {\r\n      setUser(user);\r\n      setIsAuthReady(true);\r\n    });\r\n  }, []);\r\n\r\n  const signIn = useCallback(() => {\r\n    const provider = new firebase.auth.GoogleAuthProvider();\r\n    provider.addScope('https://www.googleapis.com/auth/plus.login');\r\n\r\n    return firebase\r\n      .auth()\r\n      .signInWithPopup(provider)\r\n      .then(user => {\r\n        setUser(user.user);\r\n      });\r\n  }, []);\r\n\r\n  const signOut = useCallback(() => {\r\n    return firebase\r\n      .auth()\r\n      .signOut()\r\n      .then(() => {\r\n        setUser(null);\r\n      });\r\n  }, []);\r\n\r\n  return { user, signIn, signOut, isAuthReady, getToken };\r\n}\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\n\r\nexport function getPasscode() {\r\n  const match = window.location.search.match(/passcode=(.*)&?/);\r\n  const passcode = match ? match[1] : window.sessionStorage.getItem('passcode');\r\n  return passcode;\r\n}\r\n\r\nexport function fetchToken(name: string, room: string, passcode: string) {\r\n  return fetch(`/token`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'content-type': 'application/json',\r\n    },\r\n    body: JSON.stringify({ user_identity: name, room_name: room, passcode }),\r\n  });\r\n}\r\n\r\nexport function verifyPasscode(passcode: string) {\r\n  return fetchToken('temp-name', 'temp-room', passcode).then(async res => {\r\n    const jsonResponse = await res.json();\r\n    if (res.status === 401) {\r\n      return { isValid: false, error: jsonResponse.error?.message };\r\n    }\r\n\r\n    if (res.ok && jsonResponse.token) {\r\n      return { isValid: true };\r\n    }\r\n  });\r\n}\r\n\r\nexport function getErrorMessage(message: string) {\r\n  switch (message) {\r\n    case 'passcode incorrect':\r\n      return 'Passcode is incorrect';\r\n    case 'passcode expired':\r\n      return 'Passcode has expired';\r\n    default:\r\n      return message;\r\n  }\r\n}\r\n\r\nexport default function usePasscodeAuth() {\r\n  const history = useHistory();\r\n\r\n  const [user, setUser] = useState<{ displayName: undefined; photoURL: undefined; passcode: string } | null>(null);\r\n  const [isAuthReady, setIsAuthReady] = useState(false);\r\n\r\n  const getToken = useCallback(\r\n    (name: string, room: string) => {\r\n      return fetchToken(name, room, user!.passcode)\r\n        .then(async res => {\r\n          if (res.ok) {\r\n            return res;\r\n          }\r\n          const json = await res.json();\r\n          const errorMessage = getErrorMessage(json.error?.message || res.statusText);\r\n          throw Error(errorMessage);\r\n        })\r\n        .then(res => res.json())\r\n        .then(res => res.token as string);\r\n    },\r\n    [user]\r\n  );\r\n\r\n  useEffect(() => {\r\n    const passcode = getPasscode();\r\n\r\n    if (passcode) {\r\n      verifyPasscode(passcode)\r\n        .then(verification => {\r\n          if (verification?.isValid) {\r\n            setUser({ passcode } as any);\r\n            window.sessionStorage.setItem('passcode', passcode);\r\n            history.replace(window.location.pathname);\r\n          }\r\n        })\r\n        .then(() => setIsAuthReady(true));\r\n    } else {\r\n      setIsAuthReady(true);\r\n    }\r\n  }, [history]);\r\n\r\n  const signIn = useCallback((passcode: string) => {\r\n    return verifyPasscode(passcode).then(verification => {\r\n      if (verification?.isValid) {\r\n        setUser({ passcode } as any);\r\n        window.sessionStorage.setItem('passcode', passcode);\r\n      } else {\r\n        throw new Error(getErrorMessage(verification?.error));\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  const signOut = useCallback(() => {\r\n    setUser(null);\r\n    window.sessionStorage.removeItem('passcode');\r\n    return Promise.resolve();\r\n  }, []);\r\n\r\n  return { user, isAuthReady, getToken, signIn, signOut };\r\n}\r\n","import React, { createContext, useContext, useState } from 'react';\r\nimport { TwilioError } from 'twilio-video';\r\nimport useFirebaseAuth from './useFirebaseAuth/useFirebaseAuth';\r\nimport usePasscodeAuth from './usePasscodeAuth/usePasscodeAuth';\r\nimport { User } from 'firebase';\r\n\r\nexport interface StateContextType {\r\n  error: TwilioError | null;\r\n  setError(error: TwilioError | null): void;\r\n  getToken(name: string, room: string, password: string): Promise<string>;\r\n  user?: User | null | { displayName: undefined; photoURL: undefined; passcode?: string };\r\n  signIn?(passcode?: string): Promise<void>;\r\n  signOut?(): Promise<void>;\r\n  isAuthReady?: boolean;\r\n  isFetching: boolean;\r\n}\r\n\r\nexport const StateContext = createContext<StateContextType>(null!);\r\n\r\n/*\r\n  The 'react-hooks/rules-of-hooks' linting rules prevent React Hooks fron being called\r\n  inside of if() statements. This is because hooks must always be called in the same order\r\n  every time a component is rendered. The 'react-hooks/rules-of-hooks' rule is disabled below\r\n  because the \"if (process.env.REACT_APP_SET_AUTH === 'firebase')\" statements are evaluated\r\n  at build time (not runtime). If the statement evaluates to false, then the code is not\r\n  included in the bundle that is produced (due to tree-shaking). Thus, in this instance, it\r\n  is ok to call hooks inside if() statements.\r\n*/\r\nexport default function AppStateProvider(props: React.PropsWithChildren<{}>) {\r\n  const [error, setError] = useState<TwilioError | null>(null);\r\n  const [isFetching, setIsFetching] = useState(false);\r\n\r\n  let contextValue = {\r\n    error,\r\n    setError,\r\n    isFetching,\r\n  } as StateContextType;\r\n\r\n  if (process.env.REACT_APP_SET_AUTH === 'firebase') {\r\n    contextValue = {\r\n      ...contextValue,\r\n      ...useFirebaseAuth(), // eslint-disable-line react-hooks/rules-of-hooks\r\n    };\r\n  } else if (process.env.REACT_APP_SET_AUTH === 'passcode') {\r\n    contextValue = {\r\n      ...contextValue,\r\n      ...usePasscodeAuth(), // eslint-disable-line react-hooks/rules-of-hooks\r\n    };\r\n  } else {\r\n    contextValue = {\r\n      ...contextValue,\r\n      getToken: async (identity, roomName, password) => {\r\n        const headers = new window.Headers();\r\n        const endpoint = process.env.REACT_APP_TOKEN_ENDPOINT || '/token';\r\n        const params = new window.URLSearchParams({ identity, roomName, password });\r\n\r\n        return fetch(`${endpoint}?${params}`, { headers }).then(res => res.text());\r\n      },\r\n    };\r\n  }\r\n\r\n  const getToken: StateContextType['getToken'] = (name, room, password) => {\r\n    setIsFetching(true);\r\n    return contextValue\r\n      .getToken(name, room, password)\r\n      .then(res => {\r\n        setIsFetching(false);\r\n        return res;\r\n      })\r\n      .catch(err => {\r\n        setError(err);\r\n        setIsFetching(false);\r\n        return Promise.reject(err);\r\n      });\r\n  };\r\n\r\n  return <StateContext.Provider value={{ ...contextValue, getToken }}>{props.children}</StateContext.Provider>;\r\n}\r\n\r\nexport function useAppState() {\r\n  const context = useContext(StateContext);\r\n  if (!context) {\r\n    throw new Error('useAppState must be used within the AppStateProvider');\r\n  }\r\n  return context;\r\n}\r\n","import React, { useState, useRef, useCallback } from 'react';\r\nimport AboutDialog from '../AboutDialog/AboutDialog';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuContainer from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport MoreIcon from '@material-ui/icons/MoreVert';\r\nimport UserAvatar from '../UserAvatar/UserAvatar';\r\n\r\nimport { useAppState } from '../../../state';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport default function Menu() {\r\n  const { user, signOut } = useAppState();\r\n  const { room, localTracks } = useVideoContext();\r\n\r\n  const [aboutOpen, setAboutOpen] = useState(false);\r\n  const [menuOpen, setMenuOpen] = useState(false);\r\n\r\n  const anchorRef = useRef<HTMLDivElement>(null);\r\n\r\n  const handleSignOut = useCallback(() => {\r\n    room.disconnect?.();\r\n    localTracks.forEach(track => track.stop());\r\n    signOut?.();\r\n  }, [room.disconnect, localTracks, signOut]);\r\n\r\n  return (\r\n    <div ref={anchorRef}>\r\n      <IconButton color=\"inherit\" onClick={() => setMenuOpen(state => !state)}>\r\n        {user ? <UserAvatar user={user} /> : <MoreIcon />}\r\n      </IconButton>\r\n      <MenuContainer open={menuOpen} onClose={() => setMenuOpen(state => !state)} anchorEl={anchorRef.current}>\r\n        {user?.displayName && <MenuItem disabled>{user.displayName}</MenuItem>}\r\n        <MenuItem onClick={() => setAboutOpen(true)}>About</MenuItem>\r\n        {user && <MenuItem onClick={handleSignOut}>Logout</MenuItem>}\r\n      </MenuContainer>\r\n      <AboutDialog\r\n        open={aboutOpen}\r\n        onClose={() => {\r\n          setAboutOpen(false);\r\n          setMenuOpen(false);\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import React, { ChangeEvent, FormEvent, useState, useEffect } from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport ToggleFullscreenButton from '../ToggleFullScreenButton/ToggleFullScreenButton';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Menu from './Menu/Menu';\r\n\r\nimport { useAppState } from '../../state';\r\nimport { useParams } from 'react-router-dom';\r\nimport useRoomState from '../../hooks/useRoomState/useRoomState';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\nimport { Typography } from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    container: {\r\n      backgroundColor: theme.palette.background.default,\r\n    },\r\n    form: {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n    },\r\n    textField: {\r\n      marginLeft: theme.spacing(1),\r\n      marginRight: theme.spacing(1),\r\n      width: 200,\r\n    },\r\n    loadingSpinner: {\r\n      marginLeft: '1em',\r\n    },\r\n    displayName: {\r\n      marginLeft: '2.2em',\r\n      minWidth: '200px',\r\n      fontWeight: 600,\r\n    },\r\n  })\r\n);\r\n\r\nexport default function MenuBar() {\r\n  const classes = useStyles();\r\n  const { URLRoomName } = useParams();\r\n  const { user, getToken, isFetching } = useAppState();\r\n  const { isConnecting, connect } = useVideoContext();\r\n  const roomState = useRoomState();\r\n\r\n  const [name, setName] = useState<string>(user?.displayName || '');\r\n  const [password, setPassword] = useState<string>('');\r\n  const [roomName, setRoomName] = useState<string>('');\r\n\r\n  useEffect(() => {\r\n    if (URLRoomName) {\r\n      setRoomName(URLRoomName);\r\n    }\r\n  }, [URLRoomName]);\r\n\r\n  const handleNameChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n    setName(event.target.value);\r\n  };\r\n\r\n  const handleRoomNameChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n    setRoomName(event.target.value);\r\n  };\r\n\r\n  const handlePasswordChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n    setPassword(event.target.value);\r\n  };\r\n\r\n  const handleSubmit = (event: FormEvent<HTMLFormElement>) => {\r\n    event.preventDefault();\r\n    // If this app is deployed as a twilio function, don't change the URL beacuse routing isn't supported.\r\n    if (!window.location.origin.includes('twil.io')) {\r\n      window.history.replaceState(null, '', window.encodeURI(`/room/${roomName}`));\r\n    }\r\n    getToken(name, roomName, password).then(token => connect(token));\r\n  };\r\n\r\n  return (\r\n    <AppBar className={classes.container} position=\"static\">\r\n      <Toolbar>\r\n        {roomState === 'disconnected' ? (\r\n          <form className={classes.form} onSubmit={handleSubmit}>\r\n            {!user?.displayName ? (\r\n              <TextField\r\n                id=\"menu-name\"\r\n                label=\"Name\"\r\n                className={classes.textField}\r\n                value={name}\r\n                onChange={handleNameChange}\r\n                margin=\"dense\"\r\n              />\r\n            ) : (\r\n              <Typography className={classes.displayName} variant=\"body1\">\r\n                {user.displayName}\r\n              </Typography>\r\n            )}\r\n            <TextField\r\n              id=\"menu-room\"\r\n              label=\"Room\"\r\n              className={classes.textField}\r\n              value={roomName}\r\n              onChange={handleRoomNameChange}\r\n              margin=\"dense\"\r\n            />\r\n            <TextField\r\n              id=\"menu-password\"\r\n              label=\"Password\"\r\n              className={classes.textField}\r\n              value={password}\r\n              onChange={handlePasswordChange}\r\n              margin=\"dense\"\r\n            />\r\n            <Button\r\n              type=\"submit\"\r\n              color=\"primary\"\r\n              variant=\"contained\"\r\n              disabled={isConnecting || !name || !roomName || isFetching}\r\n            >\r\n              Join Room\r\n            </Button>\r\n            {(isConnecting || isFetching) && <CircularProgress className={classes.loadingSpinner} />}\r\n          </form>\r\n        ) : (\r\n          <h3>{roomName}</h3>\r\n        )}\r\n        <ToggleFullscreenButton />\r\n        <Menu />\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport { SnackbarContent } from '@material-ui/core';\r\n\r\nimport useRoomState from '../../hooks/useRoomState/useRoomState';\r\n\r\nconst useStyles = makeStyles({\r\n  snackbar: {\r\n    backgroundColor: '#6db1ff',\r\n  },\r\n  message: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n  },\r\n  icon: {\r\n    marginRight: '0.8em',\r\n  },\r\n});\r\n\r\nexport default function ReconnectingNotification() {\r\n  const classes = useStyles();\r\n  const roomState = useRoomState();\r\n\r\n  return (\r\n    <Snackbar anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }} open={roomState === 'reconnecting'}>\r\n      <SnackbarContent\r\n        className={classes.snackbar}\r\n        message={\r\n          <span className={classes.message}>\r\n            <InfoIcon className={classes.icon} />\r\n            Reconnecting&hellip;\r\n          </span>\r\n        }\r\n      />\r\n    </Snackbar>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { styled } from '@material-ui/core';\r\n\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\r\n\r\nconst BandwidthWarningContainer = styled('div')({\r\n  position: 'absolute',\r\n  zIndex: 1,\r\n  width: '100%',\r\n  display: 'flex',\r\n  flexDirection: 'column',\r\n  justifyContent: 'center',\r\n  alignItems: 'center',\r\n});\r\n\r\nconst Warning = styled('h3')({\r\n  textAlign: 'center',\r\n  margin: '0.6em 0',\r\n});\r\n\r\nexport default function BandwidthWarning() {\r\n  return (\r\n    <BandwidthWarningContainer>\r\n      <div>\r\n        <ErrorOutlineIcon fontSize=\"large\" />\r\n      </div>\r\n      <Warning>Insufficient Bandwidth</Warning>\r\n    </BandwidthWarningContainer>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { styled } from '@material-ui/core/styles';\r\n\r\nconst Container = styled('div')({\r\n  display: 'flex',\r\n  alignItems: 'flex-end',\r\n  '& div': {\r\n    width: '2px',\r\n    border: '1px solid black',\r\n    boxSizing: 'content-box',\r\n    '&:not(:last-child)': {\r\n      borderRight: 'none',\r\n    },\r\n  },\r\n});\r\n\r\nconst STEP = 3;\r\n\r\nexport default function NetworkQualityLevel({ qualityLevel }: { qualityLevel: number | null }) {\r\n  if (qualityLevel === null) return null;\r\n  return (\r\n    <Container>\r\n      {[0, 1, 2, 3, 4].map(level => (\r\n        <div\r\n          key={level}\r\n          style={{\r\n            height: `${STEP * (level + 1)}px`,\r\n            background: qualityLevel > level ? '#0c0' : '#040',\r\n          }}\r\n        />\r\n      ))}\r\n    </Container>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { LocalParticipant, RemoteParticipant } from 'twilio-video';\r\nimport useParticipantIsReconnecting from '../../../hooks/useParticipantIsReconnecting/useParticipantIsReconnecting';\r\nimport { Tooltip } from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles({\r\n  indicator: {\r\n    width: '10px',\r\n    height: '10px',\r\n    borderRadius: '100%',\r\n    background: '#0c0',\r\n    display: 'inline-block',\r\n    marginRight: '3px',\r\n  },\r\n  isReconnecting: {\r\n    background: '#ffb100',\r\n  },\r\n});\r\n\r\nexport default function ParticipantConnectionIndicator({\r\n  participant,\r\n}: {\r\n  participant: LocalParticipant | RemoteParticipant;\r\n}) {\r\n  const isReconnecting = useParticipantIsReconnecting(participant);\r\n  const classes = useStyles();\r\n  return (\r\n    <Tooltip title={isReconnecting ? 'Participant is reconnecting' : 'Participant is connected'}>\r\n      <span className={clsx(classes.indicator, { [classes.isReconnecting]: isReconnecting })}></span>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { LocalParticipant, RemoteParticipant } from 'twilio-video';\r\n\r\nexport default function useParticipantIsReconnecting(participant: LocalParticipant | RemoteParticipant) {\r\n  const [isReconnecting, setIsReconnecting] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const handleReconnecting = () => setIsReconnecting(true);\r\n    const handleReconnected = () => setIsReconnecting(false);\r\n\r\n    participant.on('reconnecting', handleReconnecting);\r\n    participant.on('reconnected', handleReconnected);\r\n    return () => {\r\n      participant.off('reconnecting', handleReconnecting);\r\n      participant.off('reconnected', handleReconnected);\r\n    };\r\n  }, [participant]);\r\n\r\n  return isReconnecting;\r\n}\r\n","import React from 'react';\r\nimport { Pin } from '@primer/octicons-react';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport SvgIcon from '@material-ui/core/SvgIcon';\r\n\r\nexport default function PinIcon() {\r\n  return (\r\n    <Tooltip title=\"Participant is pinned. Click to un-pin.\" placement=\"top\">\r\n      <SvgIcon style={{ float: 'right', fontSize: '29px' }}>\r\n        <Pin />\r\n      </SvgIcon>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { LocalTrackPublication, Participant, RemoteTrackPublication } from 'twilio-video';\r\n\r\ntype TrackPublication = LocalTrackPublication | RemoteTrackPublication;\r\n\r\nexport default function usePublications(participant: Participant) {\r\n  const [publications, setPublications] = useState<TrackPublication[]>([]);\r\n\r\n  useEffect(() => {\r\n    // Reset the publications when the 'participant' variable changes.\r\n    setPublications(Array.from(participant.tracks.values()) as TrackPublication[]);\r\n\r\n    const publicationAdded = (publication: TrackPublication) =>\r\n      setPublications(prevPublications => [...prevPublications, publication]);\r\n    const publicationRemoved = (publication: TrackPublication) =>\r\n      setPublications(prevPublications => prevPublications.filter(p => p !== publication));\r\n\r\n    participant.on('trackPublished', publicationAdded);\r\n    participant.on('trackUnpublished', publicationRemoved);\r\n    return () => {\r\n      participant.off('trackPublished', publicationAdded);\r\n      participant.off('trackUnpublished', publicationRemoved);\r\n    };\r\n  }, [participant]);\r\n\r\n  return publications;\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { LocalVideoTrack, RemoteVideoTrack } from 'twilio-video';\r\n\r\ntype TrackType = RemoteVideoTrack | LocalVideoTrack | undefined | null;\r\n\r\n// The 'switchedOff' event is emitted when there is not enough bandwidth to support\r\n// a track. See: https://www.twilio.com/docs/video/tutorials/using-bandwidth-profile-api#understanding-track-switch-offs\r\n\r\nexport default function useIsTrackSwitchedOff(track: TrackType) {\r\n  const [isSwitchedOff, setIsSwitchedOff] = useState(track && track.isSwitchedOff);\r\n\r\n  useEffect(() => {\r\n    // Reset the value if the 'track' variable changes\r\n    setIsSwitchedOff(track && track.isSwitchedOff);\r\n\r\n    if (track) {\r\n      const handleSwitchedOff = () => setIsSwitchedOff(true);\r\n      const handleSwitchedOn = () => setIsSwitchedOff(false);\r\n      track.on('switchedOff', handleSwitchedOff);\r\n      track.on('switchedOn', handleSwitchedOn);\r\n      return () => {\r\n        track.off('switchedOff', handleSwitchedOff);\r\n        track.off('switchedOn', handleSwitchedOn);\r\n      };\r\n    }\r\n  }, [track]);\r\n\r\n  return !!isSwitchedOff;\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { LocalTrackPublication, RemoteTrackPublication } from 'twilio-video';\r\n\r\nexport default function useTrack(publication: LocalTrackPublication | RemoteTrackPublication | undefined) {\r\n  const [track, setTrack] = useState(publication && publication.track);\r\n\r\n  useEffect(() => {\r\n    // Reset the track when the 'publication' variable changes.\r\n    setTrack(publication && publication.track);\r\n\r\n    if (publication) {\r\n      const removeTrack = () => setTrack(null);\r\n\r\n      publication.on('subscribed', setTrack);\r\n      publication.on('unsubscribed', removeTrack);\r\n      return () => {\r\n        publication.off('subscribed', setTrack);\r\n        publication.off('unsubscribed', removeTrack);\r\n      };\r\n    }\r\n  }, [publication]);\r\n\r\n  return track;\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\nimport { LocalParticipant, RemoteParticipant, RemoteVideoTrack, LocalVideoTrack } from 'twilio-video';\r\n\r\nimport BandwidthWarning from '../BandwidthWarning/BandwidthWarning';\r\nimport MicOff from '@material-ui/icons/MicOff';\r\nimport NetworkQualityLevel from '../NewtorkQualityLevel/NetworkQualityLevel';\r\nimport ParticipantConnectionIndicator from './ParticipantConnectionIndicator/ParticipantConnectionIndicator';\r\nimport PinIcon from './PinIcon/PinIcon';\r\nimport ScreenShare from '@material-ui/icons/ScreenShare';\r\nimport VideocamOff from '@material-ui/icons/VideocamOff';\r\n\r\nimport useParticipantNetworkQualityLevel from '../../hooks/useParticipantNetworkQualityLevel/useParticipantNetworkQualityLevel';\r\nimport usePublications from '../../hooks/usePublications/usePublications';\r\nimport useIsTrackSwitchedOff from '../../hooks/useIsTrackSwitchedOff/useIsTrackSwitchedOff';\r\nimport usePublicationIsTrackEnabled from '../../hooks/usePublicationIsTrackEnabled/usePublicationIsTrackEnabled';\r\nimport useTrack from '../../hooks/useTrack/useTrack';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    container: {\r\n      position: 'relative',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      height: `${(theme.sidebarWidth * 9) / 16}px`,\r\n      overflow: 'hidden',\r\n      cursor: 'pointer',\r\n      '& video': {\r\n        filter: 'none',\r\n      },\r\n      '& svg': {\r\n        stroke: 'black',\r\n        strokeWidth: '0.8px',\r\n      },\r\n    },\r\n    isVideoSwitchedOff: {\r\n      '& video': {\r\n        filter: 'blur(4px) grayscale(1) brightness(0.5)',\r\n      },\r\n    },\r\n    infoContainer: {\r\n      position: 'absolute',\r\n      zIndex: 1,\r\n      display: 'flex',\r\n      flexDirection: 'column',\r\n      justifyContent: 'space-between',\r\n      height: '100%',\r\n      padding: '0.4em',\r\n      width: '100%',\r\n      background: 'transparent',\r\n    },\r\n    hideVideo: {\r\n      background: 'black',\r\n    },\r\n    identity: {\r\n      background: 'rgba(0, 0, 0, 0.7)',\r\n      padding: '0.1em 0.3em',\r\n      margin: 0,\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n    },\r\n    infoRow: {\r\n      display: 'flex',\r\n      justifyContent: 'space-between',\r\n    },\r\n  })\r\n);\r\n\r\ninterface ParticipantInfoProps {\r\n  participant: LocalParticipant | RemoteParticipant;\r\n  children: React.ReactNode;\r\n  onClick: () => void;\r\n  isSelected: boolean;\r\n}\r\n\r\nexport default function ParticipantInfo({ participant, onClick, isSelected, children }: ParticipantInfoProps) {\r\n  const publications = usePublications(participant);\r\n\r\n  const audioPublication = publications.find(p => p.kind === 'audio');\r\n  const videoPublication = publications.find(p => p.trackName === 'camera');\r\n\r\n  const networkQualityLevel = useParticipantNetworkQualityLevel(participant);\r\n  const isAudioEnabled = usePublicationIsTrackEnabled(audioPublication);\r\n  const isVideoEnabled = Boolean(videoPublication);\r\n  const isScreenShareEnabled = publications.find(p => p.trackName === 'screen');\r\n\r\n  const videoTrack = useTrack(videoPublication);\r\n  const isVideoSwitchedOff = useIsTrackSwitchedOff(videoTrack as LocalVideoTrack | RemoteVideoTrack);\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div\r\n      className={clsx(classes.container, {\r\n        [classes.isVideoSwitchedOff]: isVideoSwitchedOff,\r\n      })}\r\n      onClick={onClick}\r\n      data-cy-participant={participant.identity}\r\n    >\r\n      <div className={clsx(classes.infoContainer, { [classes.hideVideo]: !isVideoEnabled })}>\r\n        <div className={classes.infoRow}>\r\n          <h4 className={classes.identity}>\r\n            <ParticipantConnectionIndicator participant={participant} />\r\n            {participant.identity}\r\n          </h4>\r\n          <NetworkQualityLevel qualityLevel={networkQualityLevel} />\r\n        </div>\r\n        <div>\r\n          {!isAudioEnabled && <MicOff data-cy-audio-mute-icon />}\r\n          {!isVideoEnabled && <VideocamOff />}\r\n          {isScreenShareEnabled && <ScreenShare />}\r\n          {isSelected && <PinIcon />}\r\n        </div>\r\n      </div>\r\n      {isVideoSwitchedOff && <BandwidthWarning />}\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { LocalParticipant, RemoteParticipant } from 'twilio-video';\r\n\r\nexport default function useParticipantNetworkQualityLevel(participant: LocalParticipant | RemoteParticipant) {\r\n  const [networkQualityLevel, setNetworkQualityLevel] = useState(participant.networkQualityLevel);\r\n\r\n  useEffect(() => {\r\n    const handleNewtorkQualityLevelChange = (newNetworkQualityLevel: number) =>\r\n      setNetworkQualityLevel(newNetworkQualityLevel);\r\n\r\n    setNetworkQualityLevel(participant.networkQualityLevel);\r\n    participant.on('networkQualityLevelChanged', handleNewtorkQualityLevelChange);\r\n    return () => {\r\n      participant.off('networkQualityLevelChanged', handleNewtorkQualityLevelChange);\r\n    };\r\n  }, [participant]);\r\n\r\n  return networkQualityLevel;\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { LocalTrackPublication, RemoteTrackPublication } from 'twilio-video';\r\n\r\ntype PublicationType = LocalTrackPublication | RemoteTrackPublication;\r\n\r\nexport default function usePublicationIsTrackEnabled(publication?: PublicationType) {\r\n  const [isEnabled, setIsEnabled] = useState(publication ? publication.isTrackEnabled : false);\r\n\r\n  useEffect(() => {\r\n    setIsEnabled(publication ? publication.isTrackEnabled : false);\r\n\r\n    if (publication) {\r\n      const setEnabled = () => setIsEnabled(true);\r\n      const setDisabled = () => setIsEnabled(false);\r\n      publication.on('trackEnabled', setEnabled);\r\n      publication.on('trackDisabled', setDisabled);\r\n      return () => {\r\n        publication.off('trackEnabled', setEnabled);\r\n        publication.off('trackDisabled', setDisabled);\r\n      };\r\n    }\r\n  }, [publication]);\r\n\r\n  return isEnabled;\r\n}\r\n","import React, { useEffect, useRef } from 'react';\r\nimport { AudioTrack as IAudioTrack } from 'twilio-video';\r\n\r\ninterface AudioTrackProps {\r\n  track: IAudioTrack;\r\n}\r\n\r\nexport default function AudioTrack({ track }: AudioTrackProps) {\r\n  const ref = useRef<HTMLAudioElement>(null!);\r\n\r\n  useEffect(() => {\r\n    const el = ref.current;\r\n    track.attach(el);\r\n    return () => {\r\n      track.detach(el);\r\n    };\r\n  }, [track]);\r\n\r\n  return <audio ref={ref} />;\r\n}\r\n","import React from 'react';\r\nimport useTrack from '../../hooks/useTrack/useTrack';\r\nimport AudioTrack from '../AudioTrack/AudioTrack';\r\nimport VideoTrack from '../VideoTrack/VideoTrack';\r\n\r\nimport { IVideoTrack } from '../../types';\r\nimport {\r\n  AudioTrack as IAudioTrack,\r\n  LocalTrackPublication,\r\n  Participant,\r\n  RemoteTrackPublication,\r\n  Track,\r\n} from 'twilio-video';\r\n\r\ninterface PublicationProps {\r\n  publication: LocalTrackPublication | RemoteTrackPublication;\r\n  participant: Participant;\r\n  isLocal: boolean;\r\n  disableAudio?: boolean;\r\n  videoPriority?: Track.Priority | null;\r\n}\r\n\r\nexport default function Publication({ publication, isLocal, disableAudio, videoPriority }: PublicationProps) {\r\n  const track = useTrack(publication);\r\n\r\n  if (!track) return null;\r\n\r\n  switch (track.kind) {\r\n    case 'video':\r\n      return (\r\n        <VideoTrack\r\n          track={track as IVideoTrack}\r\n          priority={videoPriority}\r\n          isLocal={track.name === 'camera' && isLocal}\r\n        />\r\n      );\r\n    case 'audio':\r\n      return disableAudio ? null : <AudioTrack track={track as IAudioTrack} />;\r\n    default:\r\n      return null;\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { LocalParticipant, RemoteParticipant, Track } from 'twilio-video';\r\nimport Publication from '../Publication/Publication';\r\nimport usePublications from '../../hooks/usePublications/usePublications';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\n\r\ninterface ParticipantTracksProps {\r\n  participant: LocalParticipant | RemoteParticipant;\r\n  disableAudio?: boolean;\r\n  enableScreenShare?: boolean;\r\n  videoPriority?: Track.Priority | null;\r\n}\r\n\r\n/*\r\n *  The object model for the Room object (found here: https://www.twilio.com/docs/video/migrating-1x-2x#object-model) shows\r\n *  that Participant objects have TrackPublications, and TrackPublication objects have Tracks.\r\n *\r\n *  The React components in this application follow the same pattern. This ParticipantTracks component renders Publications,\r\n *  and the Publication component renders Tracks.\r\n */\r\n\r\nexport default function ParticipantTracks({\r\n  participant,\r\n  disableAudio,\r\n  enableScreenShare,\r\n  videoPriority,\r\n}: ParticipantTracksProps) {\r\n  const { room } = useVideoContext();\r\n  const publications = usePublications(participant);\r\n  const isLocal = participant === room.localParticipant;\r\n\r\n  let filteredPublications;\r\n\r\n  if (enableScreenShare && publications.some(p => p.trackName === 'screen')) {\r\n    filteredPublications = publications.filter(p => p.trackName !== 'camera');\r\n  } else {\r\n    filteredPublications = publications.filter(p => p.trackName !== 'screen');\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {filteredPublications.map(publication => (\r\n        <Publication\r\n          key={publication.kind}\r\n          publication={publication}\r\n          participant={participant}\r\n          isLocal={isLocal}\r\n          disableAudio={disableAudio}\r\n          videoPriority={videoPriority}\r\n        />\r\n      ))}\r\n    </>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport ParticipantInfo from '../ParticipantInfo/ParticipantInfo';\r\nimport ParticipantTracks from '../ParticipantTracks/ParticipantTracks';\r\nimport { LocalParticipant, RemoteParticipant } from 'twilio-video';\r\n\r\ninterface ParticipantProps {\r\n  participant: LocalParticipant | RemoteParticipant;\r\n  disableAudio?: boolean;\r\n  enableScreenShare?: boolean;\r\n  onClick: () => void;\r\n  isSelected: boolean;\r\n}\r\n\r\nexport default function Participant({\r\n  participant,\r\n  disableAudio,\r\n  enableScreenShare,\r\n  onClick,\r\n  isSelected,\r\n}: ParticipantProps) {\r\n  return (\r\n    <ParticipantInfo participant={participant} onClick={onClick} isSelected={isSelected}>\r\n      <ParticipantTracks participant={participant} disableAudio={disableAudio} enableScreenShare={enableScreenShare} />\r\n    </ParticipantInfo>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\nimport { RemoteParticipant } from 'twilio-video';\r\n\r\nexport default function useDominantSpeaker() {\r\n  const { room } = useVideoContext();\r\n  const [dominantSpeaker, setDominantSpeaker] = useState(room.dominantSpeaker);\r\n\r\n  useEffect(() => {\r\n    // Sometimes, the 'dominantSpeakerChanged' event can emit 'null', which means that\r\n    // there is no dominant speaker. If we change the main participant when 'null' is\r\n    // emitted, the effect can be jarring to the user. Here we ignore any 'null' values\r\n    // and continue to display the previous dominant speaker as the main participant.\r\n    const handleDominantSpeakerChanged = (newDominantSpeaker: RemoteParticipant) => {\r\n      if (newDominantSpeaker !== null) {\r\n        setDominantSpeaker(newDominantSpeaker);\r\n      }\r\n    };\r\n\r\n    // Since 'null' values are ignored, we will need to listen for the 'participantDisconnected'\r\n    // event, so we can set the dominantSpeaker to 'null' when they disconnect.\r\n    const handleParticipantDisconnected = (participant: RemoteParticipant) => {\r\n      setDominantSpeaker(prevDominantSpeaker => {\r\n        return prevDominantSpeaker === participant ? null : prevDominantSpeaker;\r\n      });\r\n    };\r\n\r\n    room.on('dominantSpeakerChanged', handleDominantSpeakerChanged);\r\n    room.on('participantDisconnected', handleParticipantDisconnected);\r\n    return () => {\r\n      room.off('dominantSpeakerChanged', handleDominantSpeakerChanged);\r\n      room.off('participantDisconnected', handleParticipantDisconnected);\r\n    };\r\n  }, [room]);\r\n\r\n  return dominantSpeaker;\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { RemoteParticipant } from 'twilio-video';\r\nimport useDominantSpeaker from '../useDominantSpeaker/useDominantSpeaker';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\nexport default function useParticipants() {\r\n  const { room } = useVideoContext();\r\n  const dominantSpeaker = useDominantSpeaker();\r\n  const [participants, setParticipants] = useState(Array.from(room.participants.values()));\r\n\r\n  // When the dominant speaker changes, they are moved to the front of the participants array.\r\n  // This means that the most recent dominant speakers will always be near the top of the\r\n  // ParticipantStrip component.\r\n  useEffect(() => {\r\n    if (dominantSpeaker) {\r\n      setParticipants(prevParticipants => [\r\n        dominantSpeaker,\r\n        ...prevParticipants.filter(participant => participant !== dominantSpeaker),\r\n      ]);\r\n    }\r\n  }, [dominantSpeaker]);\r\n\r\n  useEffect(() => {\r\n    const participantConnected = (participant: RemoteParticipant) =>\r\n      setParticipants(prevParticipants => [...prevParticipants, participant]);\r\n    const participantDisconnected = (participant: RemoteParticipant) =>\r\n      setParticipants(prevParticipants => prevParticipants.filter(p => p !== participant));\r\n    room.on('participantConnected', participantConnected);\r\n    room.on('participantDisconnected', participantDisconnected);\r\n    return () => {\r\n      room.off('participantConnected', participantConnected);\r\n      room.off('participantDisconnected', participantDisconnected);\r\n    };\r\n  }, [room]);\r\n\r\n  return participants;\r\n}\r\n","import React from 'react';\r\nimport Participant from '../Participant/Participant';\r\nimport { styled } from '@material-ui/core/styles';\r\nimport useParticipants from '../../hooks/useParticipants/useParticipants';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\nimport useSelectedParticipant from '../VideoProvider/useSelectedParticipant/useSelectedParticipant';\r\n\r\nconst Container = styled('aside')(({ theme }) => ({\r\n  position: 'absolute',\r\n  top: 0,\r\n  bottom: 0,\r\n  right: `calc(100% - ${theme.sidebarWidth}px)`,\r\n  left: 0,\r\n  padding: '0.5em',\r\n  overflowY: 'auto',\r\n}));\r\n\r\nexport default function ParticipantStrip() {\r\n  const {\r\n    room: { localParticipant },\r\n  } = useVideoContext();\r\n  const participants = useParticipants();\r\n  const [selectedParticipant, setSelectedParticipant] = useSelectedParticipant();\r\n\r\n  return (\r\n    <Container>\r\n      <Participant\r\n        participant={localParticipant}\r\n        isSelected={selectedParticipant === localParticipant}\r\n        onClick={() => setSelectedParticipant(localParticipant)}\r\n      />\r\n      {participants.map(participant => (\r\n        <Participant\r\n          key={participant.sid}\r\n          participant={participant}\r\n          isSelected={selectedParticipant === participant}\r\n          onClick={() => setSelectedParticipant(participant)}\r\n        />\r\n      ))}\r\n    </Container>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { LocalParticipant, RemoteParticipant, RemoteVideoTrack, LocalVideoTrack } from 'twilio-video';\r\n\r\nimport BandwidthWarning from '../BandwidthWarning/BandwidthWarning';\r\nimport useIsTrackSwitchedOff from '../../hooks/useIsTrackSwitchedOff/useIsTrackSwitchedOff';\r\nimport usePublications from '../../hooks/usePublications/usePublications';\r\nimport useTrack from '../../hooks/useTrack/useTrack';\r\nimport VideocamOff from '@material-ui/icons/VideocamOff';\r\n\r\nconst useStyles = makeStyles({\r\n  container: {\r\n    position: 'relative',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n  },\r\n  isVideoSwitchedOff: {\r\n    '& video': {\r\n      filter: 'blur(4px) grayscale(1) brightness(0.5)',\r\n    },\r\n  },\r\n  identity: {\r\n    background: 'rgba(0, 0, 0, 0.7)',\r\n    padding: '0.1em 0.3em',\r\n    margin: '1em',\r\n    fontSize: '1.2em',\r\n    display: 'inline-flex',\r\n    '& svg': {\r\n      marginLeft: '0.3em',\r\n    },\r\n  },\r\n  infoContainer: {\r\n    position: 'absolute',\r\n    zIndex: 1,\r\n    height: '100%',\r\n    padding: '0.4em',\r\n    width: '100%',\r\n  },\r\n});\r\n\r\ninterface MainParticipantInfoProps {\r\n  participant: LocalParticipant | RemoteParticipant;\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport default function MainParticipantInfo({ participant, children }: MainParticipantInfoProps) {\r\n  const classes = useStyles();\r\n\r\n  const publications = usePublications(participant);\r\n  const videoPublication = publications.find(p => p.trackName === 'camera');\r\n  const screenSharePublication = publications.find(p => p.trackName === 'screen');\r\n  const isVideoEnabled = Boolean(videoPublication);\r\n\r\n  const videoTrack = useTrack(screenSharePublication || videoPublication);\r\n  const isVideoSwitchedOff = useIsTrackSwitchedOff(videoTrack as LocalVideoTrack | RemoteVideoTrack);\r\n\r\n  return (\r\n    <div\r\n      data-cy-main-participant\r\n      className={clsx(classes.container, { [classes.isVideoSwitchedOff]: isVideoSwitchedOff })}\r\n    >\r\n      <div className={classes.infoContainer}>\r\n        <h4 className={classes.identity}>\r\n          {participant.identity}\r\n          {!isVideoEnabled && <VideocamOff />}\r\n        </h4>\r\n      </div>\r\n      {isVideoSwitchedOff && <BandwidthWarning />}\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n","import MainParticipantInfo from '../MainParticipantInfo/MainParticipantInfo';\r\nimport ParticipantTracks from '../ParticipantTracks/ParticipantTracks';\r\nimport React from 'react';\r\nimport useMainSpeaker from '../../hooks/useMainSpeaker/useMainSpeaker';\r\nimport useSelectedParticipant from '../VideoProvider/useSelectedParticipant/useSelectedParticipant';\r\nimport useScreenShareParticipant from '../../hooks/useScreenShareParticipant/useScreenShareParticipant';\r\n\r\nexport default function MainParticipant() {\r\n  const mainParticipant = useMainSpeaker();\r\n  const [selectedParticipant] = useSelectedParticipant();\r\n  const screenShareParticipant = useScreenShareParticipant();\r\n\r\n  const videoPriority =\r\n    mainParticipant === selectedParticipant || mainParticipant === screenShareParticipant ? 'high' : null;\r\n\r\n  return (\r\n    /* audio is disabled for this participant component because this participant's audio \r\n       is already being rendered in the <ParticipantStrip /> component.  */\r\n    // @ts-ignore\r\n    <MainParticipantInfo participant={mainParticipant}>\r\n      // @ts-ignore\r\n      <ParticipantTracks participant={mainParticipant} disableAudio enableScreenShare videoPriority={videoPriority} />\r\n    </MainParticipantInfo>\r\n  );\r\n}\r\n","import useVideoContext from '../useVideoContext/useVideoContext';\r\nimport useDominantSpeaker from '../useDominantSpeaker/useDominantSpeaker';\r\nimport useParticipants from '../useParticipants/useParticipants';\r\nimport useScreenShareParticipant from '../useScreenShareParticipant/useScreenShareParticipant';\r\nimport useSelectedParticipant from '../../components/VideoProvider/useSelectedParticipant/useSelectedParticipant';\r\n\r\nexport default function useMainSpeaker() {\r\n  const [selectedParticipant] = useSelectedParticipant();\r\n  const screenShareParticipant = useScreenShareParticipant();\r\n  const dominantSpeaker = useDominantSpeaker();\r\n  const participants = useParticipants();\r\n  const {\r\n    room: { localParticipant },\r\n  } = useVideoContext();\r\n\r\n  // The participant that is returned is displayed in the main video area. Changing the order of the following\r\n  // variables will change the how the main speaker is determined.\r\n  return selectedParticipant || screenShareParticipant || dominantSpeaker || participants[0] || localParticipant;\r\n}\r\n","import React from 'react';\r\nimport ParticipantStrip from '../ParticipantStrip/ParticipantStrip';\r\nimport { styled } from '@material-ui/core/styles';\r\nimport MainParticipant from '../MainParticipant/MainParticipant';\r\n\r\nconst Container = styled('div')({\r\n  position: 'relative',\r\n  height: '100%',\r\n});\r\n\r\nconst MainParticipantContainer = styled('div')(({ theme }) => ({\r\n  position: 'absolute',\r\n  left: theme.sidebarWidth,\r\n  right: 0,\r\n  top: 0,\r\n  bottom: 0,\r\n  '& > div': {\r\n    height: '100%',\r\n  },\r\n}));\r\n\r\nexport default function Room() {\r\n  return (\r\n    <Container>\r\n      <ParticipantStrip />\r\n      <MainParticipantContainer>\r\n        <MainParticipant />\r\n      </MainParticipantContainer>\r\n    </Container>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { styled } from '@material-ui/core/styles';\r\n\r\nimport Controls from './components/Controls/Controls';\r\nimport LocalVideoPreview from './components/LocalVideoPreview/LocalVideoPreview';\r\nimport MenuBar from './components/MenuBar/MenuBar';\r\nimport ReconnectingNotification from './components/ReconnectingNotification/ReconnectingNotification';\r\nimport Room from './components/Room/Room';\r\n\r\nimport useRoomState from './hooks/useRoomState/useRoomState';\r\n\r\nconst Container = styled('div')({\r\n  display: 'flex',\r\n  flexDirection: 'column',\r\n  height: '100vh',\r\n});\r\n\r\nconst Main = styled('main')({\r\n  height: '100%',\r\n  position: 'relative',\r\n});\r\n\r\nexport default function App() {\r\n  const roomState = useRoomState();\r\n\r\n  return (\r\n    <Container>\r\n      <MenuBar />\r\n      <Main>\r\n        {roomState === 'disconnected' ? <LocalVideoPreview /> : <Room />}\r\n        <Controls />\r\n      </Main>\r\n      <ReconnectingNotification />\r\n    </Container>\r\n  );\r\n}\r\n","import React, { PropsWithChildren } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport enhanceMessage from './enhanceMessage';\r\nimport { TwilioError } from 'twilio-video';\r\n\r\ninterface ErrorDialogProps {\r\n  dismissError: Function;\r\n  error: TwilioError | null;\r\n}\r\n\r\nfunction ErrorDialog({ dismissError, error }: PropsWithChildren<ErrorDialogProps>) {\r\n  const { message, code } = error || {};\r\n  const enhancedMessage = enhanceMessage(message, code);\r\n\r\n  return (\r\n    <Dialog open={error !== null} onClose={() => dismissError()} fullWidth={true} maxWidth=\"xs\">\r\n      <DialogTitle>ERROR</DialogTitle>\r\n      <DialogContent>\r\n        <DialogContentText>{enhancedMessage}</DialogContentText>\r\n        {code && (\r\n          <pre>\r\n            <code>Error Code: {code}</code>\r\n          </pre>\r\n        )}\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => dismissError()} color=\"primary\" autoFocus>\r\n          OK\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default ErrorDialog;\r\n","// This function is used to provide error messages to the user that are\r\n// different than the error messages provided by the SDK.\r\nexport default function enhanceMessage(message = '', code?: number) {\r\n  switch (code) {\r\n    case 20101: // Invalid token error\r\n      return message + '. Please make sure you are using the correct credentials.';\r\n    default:\r\n      return message;\r\n  }\r\n}\r\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"title\", null, \"btn_google_light_normal_ios\");\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"desc\", null, \"Created with Sketch.\");\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"filter\", {\n  x: \"-50%\",\n  y: \"-50%\",\n  width: \"200%\",\n  height: \"200%\",\n  filterUnits: \"objectBoundingBox\",\n  id: \"filter-1\"\n}, /*#__PURE__*/React.createElement(\"feOffset\", {\n  dx: 0,\n  dy: 1,\n  in: \"SourceAlpha\",\n  result: \"shadowOffsetOuter1\"\n}), /*#__PURE__*/React.createElement(\"feGaussianBlur\", {\n  stdDeviation: 0.5,\n  in: \"shadowOffsetOuter1\",\n  result: \"shadowBlurOuter1\"\n}), /*#__PURE__*/React.createElement(\"feColorMatrix\", {\n  values: \"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.168 0\",\n  in: \"shadowBlurOuter1\",\n  type: \"matrix\",\n  result: \"shadowMatrixOuter1\"\n}), /*#__PURE__*/React.createElement(\"feOffset\", {\n  dx: 0,\n  dy: 0,\n  in: \"SourceAlpha\",\n  result: \"shadowOffsetOuter2\"\n}), /*#__PURE__*/React.createElement(\"feGaussianBlur\", {\n  stdDeviation: 0.5,\n  in: \"shadowOffsetOuter2\",\n  result: \"shadowBlurOuter2\"\n}), /*#__PURE__*/React.createElement(\"feColorMatrix\", {\n  values: \"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.084 0\",\n  in: \"shadowBlurOuter2\",\n  type: \"matrix\",\n  result: \"shadowMatrixOuter2\"\n}), /*#__PURE__*/React.createElement(\"feMerge\", null, /*#__PURE__*/React.createElement(\"feMergeNode\", {\n  in: \"shadowMatrixOuter1\"\n}), /*#__PURE__*/React.createElement(\"feMergeNode\", {\n  in: \"shadowMatrixOuter2\"\n}), /*#__PURE__*/React.createElement(\"feMergeNode\", {\n  in: \"SourceGraphic\"\n}))), /*#__PURE__*/React.createElement(\"rect\", {\n  id: \"path-2\",\n  x: 0,\n  y: 0,\n  width: 40,\n  height: 40,\n  rx: 2\n}));\n\nvar _ref5 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Google-Button\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"9-PATCH\",\n  transform: \"translate(-608.000000, -160.000000)\"\n}), /*#__PURE__*/React.createElement(\"g\", {\n  id: \"btn_google_light_normal\",\n  transform: \"translate(-1.000000, -1.000000)\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"logo_googleg_48dp\",\n  transform: \"translate(15.000000, 15.000000)\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M17.64,9.20454545 C17.64,8.56636364 17.5827273,7.95272727 17.4763636,7.36363636 L9,7.36363636 L9,10.845 L13.8436364,10.845 C13.635,11.97 13.0009091,12.9231818 12.0477273,13.5613636 L12.0477273,15.8195455 L14.9563636,15.8195455 C16.6581818,14.2527273 17.64,11.9454545 17.64,9.20454545 L17.64,9.20454545 Z\",\n  id: \"Shape\",\n  fill: \"#4285F4\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M9,18 C11.43,18 13.4672727,17.1940909 14.9563636,15.8195455 L12.0477273,13.5613636 C11.2418182,14.1013636 10.2109091,14.4204545 9,14.4204545 C6.65590909,14.4204545 4.67181818,12.8372727 3.96409091,10.71 L0.957272727,10.71 L0.957272727,13.0418182 C2.43818182,15.9831818 5.48181818,18 9,18 L9,18 Z\",\n  id: \"Shape\",\n  fill: \"#34A853\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M3.96409091,10.71 C3.78409091,10.17 3.68181818,9.59318182 3.68181818,9 C3.68181818,8.40681818 3.78409091,7.83 3.96409091,7.29 L3.96409091,4.95818182 L0.957272727,4.95818182 C0.347727273,6.17318182 0,7.54772727 0,9 C0,10.4522727 0.347727273,11.8268182 0.957272727,13.0418182 L3.96409091,10.71 L3.96409091,10.71 Z\",\n  id: \"Shape\",\n  fill: \"#FBBC05\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M9,3.57954545 C10.3213636,3.57954545 11.5077273,4.03363636 12.4404545,4.92545455 L15.0218182,2.34409091 C13.4631818,0.891818182 11.4259091,0 9,0 C5.48181818,0 2.43818182,2.01681818 0.957272727,4.95818182 L3.96409091,7.29 C4.67181818,5.16272727 6.65590909,3.57954545 9,3.57954545 L9,3.57954545 Z\",\n  id: \"Shape\",\n  fill: \"#EA4335\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M0,0 L18,0 L18,18 L0,18 L0,0 Z\",\n  id: \"Shape\"\n})), /*#__PURE__*/React.createElement(\"g\", {\n  id: \"handles_square\"\n})));\n\nvar SvgGoogleLogo = function SvgGoogleLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"32px\",\n    height: \"32px\",\n    viewBox: \"7 7 32 32\",\n    ref: svgRef\n  }, props), title === undefined ? _ref2 : title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref3, _ref4, _ref5);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgGoogleLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/google-logo.06c50bce.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M14.4 11.3c0 1.7-1.4 3.1-3.1 3.1S8.2 13 8.2 11.3s1.4-3.1 3.1-3.1 3.1 1.4 3.1 3.1zm-3.1 4.3c-1.7 0-3.1 1.4-3.1 3.1s1.4 3.1 3.1 3.1 3.1-1.4 3.1-3.1-1.4-3.1-3.1-3.1zM30 15c0 8.3-6.7 15-15 15S0 23.3 0 15 6.7 0 15 0s15 6.7 15 15zm-4 0c0-6.1-4.9-11-11-11S4 8.9 4 15s4.9 11 11 11 11-4.9 11-11zm-7.3.6c-1.7 0-3.1 1.4-3.1 3.1s1.4 3.1 3.1 3.1 3.1-1.4 3.1-3.1-1.4-3.1-3.1-3.1zm0-7.4c-1.7 0-3.1 1.4-3.1 3.1s1.4 3.1 3.1 3.1 3.1-1.4 3.1-3.1-1.4-3.1-3.1-3.1zm51.6-2.3c.1 0 .2.1.3.2v3.2c0 .2-.2.3-.3.3H65c-.2 0-.3-.2-.3-.3V6.2c0-.2.2-.3.3-.3h5.3zm-.1 4.5H60c-.1 0-.3.1-.3.3l-1.3 5-.1.3-1.6-5.3c0-.1-.2-.3-.3-.3h-4c-.1 0-.3.1-.3.3l-1.5 5-.1.3-.1-.3-.6-2.5-.6-2.5c0-.1-.2-.3-.3-.3h-8V6.1c0-.1-.2-.3-.4-.2l-5 1.6c-.2 0-.3.1-.3.3v2.7h-1.3c-.1 0-.3.1-.3.3v3.8c0 .1.1.3.3.3h1.3v4.7c0 3.3 1.8 4.8 5.1 4.8 1.4 0 2.7-.3 3.6-.8v-4c0-.2-.2-.3-.3-.2-.5.2-1 .3-1.4.3-.9 0-1.4-.4-1.4-1.4v-3.4h2.9c.1 0 .3-.1.3-.3v-3.2L47.8 24c0 .1.2.3.3.3h4.2c.1 0 .3-.1.3-.3l1.8-5.6.9 2.9.8 2.7c0 .1.2.3.3.3h4.2c.1 0 .3-.1.3-.3l3.8-12.6V24c0 .1.1.3.3.3h5.1c.1 0 .3-.1.3-.3V10.7c0-.1-.1-.3-.2-.3zm6.7-4.5h-5.1c-.1 0-.3.1-.3.3v17.7c0 .1.1.3.3.3h5.1c.1 0 .3-.1.3-.3V6.1c0-.1-.1-.2-.3-.2zm6.8 0h-5.3c-.1 0-.3.1-.3.3v3.1c0 .1.1.3.3.3h5.3c.1 0 .3-.1.3-.3V6.1c0-.1-.1-.2-.3-.2zm-.1 4.5h-5.1c-.1 0-.3.1-.3.3v13.1c0 .1.1.3.3.3h5.1c.1 0 .3-.1.3-.3V10.7c0-.1-.1-.3-.3-.3zm16.1 6.8c0 3.8-3.2 7.1-7.7 7.1-4.4 0-7.6-3.3-7.6-7.1s3.2-7.1 7.7-7.1c4.4 0 7.6 3.3 7.6 7.1zm-5.4.1c0-1.4-1-2.5-2.2-2.4-1.3 0-2.2 1.1-2.2 2.4s1 2.4 2.2 2.4c1.3 0 2.2-1.1 2.2-2.4z\"\n});\n\nvar SvgTwilioLogo = function SvgTwilioLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    fill: \"#F22F46\",\n    viewBox: \"0 0 100 30\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgTwilioLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/twilio-logo.62d2e629.svg\";\nexport { ForwardRef as ReactComponent };","import React, { ChangeEvent, useState, FormEvent } from 'react';\r\nimport { useAppState } from '../../state';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport { ReactComponent as GoogleLogo } from './google-logo.svg';\r\nimport { ReactComponent as TwilioLogo } from './twilio-logo.svg';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport videoLogo from './video-logo.png';\r\n\r\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { useLocation, useHistory } from 'react-router-dom';\r\n\r\nconst useStyles = makeStyles({\r\n  container: {\r\n    height: '100vh',\r\n    background: '#0D122B',\r\n  },\r\n  twilioLogo: {\r\n    width: '55%',\r\n    display: 'block',\r\n  },\r\n  videoLogo: {\r\n    width: '25%',\r\n    padding: '2.4em 0 2.1em',\r\n  },\r\n  paper: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    flexDirection: 'column',\r\n    padding: '2em',\r\n    marginTop: '4em',\r\n    background: 'white',\r\n    color: 'black',\r\n  },\r\n  button: {\r\n    color: 'black',\r\n    background: 'white',\r\n    margin: '0.8em 0 0.7em',\r\n    textTransform: 'none',\r\n  },\r\n  errorMessage: {\r\n    color: 'red',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    margin: '1em 0 0.2em',\r\n    '& svg': {\r\n      marginRight: '0.4em',\r\n    },\r\n  },\r\n});\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    type: 'light',\r\n  },\r\n});\r\n\r\nexport default function LoginPage() {\r\n  const classes = useStyles();\r\n  const { signIn, user, isAuthReady } = useAppState();\r\n  const history = useHistory();\r\n  const location = useLocation<{ from: Location }>();\r\n  const [passcode, setPasscode] = useState('');\r\n  const [authError, setAuthError] = useState<Error | null>(null);\r\n\r\n  const isAuthEnabled = Boolean(process.env.REACT_APP_SET_AUTH);\r\n\r\n  const login = () => {\r\n    setAuthError(null);\r\n    signIn?.(passcode)\r\n      .then(() => {\r\n        history.replace(location?.state?.from || { pathname: '/' });\r\n      })\r\n      .catch(err => setAuthError(err));\r\n  };\r\n\r\n  const handleSubmit = (e: FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    login();\r\n  };\r\n\r\n  if (user || !isAuthEnabled) {\r\n    history.replace('/');\r\n  }\r\n\r\n  if (!isAuthReady) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <Grid container justify=\"center\" alignItems=\"flex-start\" className={classes.container}>\r\n        <Paper className={classes.paper} elevation={6}>\r\n          <TwilioLogo className={classes.twilioLogo} />\r\n          <img className={classes.videoLogo} src={videoLogo} alt=\"Video Logo\"></img>\r\n\r\n          {process.env.REACT_APP_SET_AUTH === 'firebase' && (\r\n            <Button variant=\"contained\" className={classes.button} onClick={login} startIcon={<GoogleLogo />}>\r\n              Sign in with Google\r\n            </Button>\r\n          )}\r\n\r\n          {process.env.REACT_APP_SET_AUTH === 'passcode' && (\r\n            <form onSubmit={handleSubmit}>\r\n              <Grid container alignItems=\"center\" direction=\"column\">\r\n                <TextField\r\n                  id=\"input-passcode\"\r\n                  label=\"Passcode\"\r\n                  onChange={(e: ChangeEvent<HTMLInputElement>) => setPasscode(e.target.value)}\r\n                  type=\"password\"\r\n                />\r\n                <div>\r\n                  {authError && (\r\n                    <Typography variant=\"caption\" className={classes.errorMessage}>\r\n                      <ErrorOutlineIcon />\r\n                      {authError.message}\r\n                    </Typography>\r\n                  )}\r\n                </div>\r\n                <Button variant=\"contained\" className={classes.button} type=\"submit\" disabled={!passcode.length}>\r\n                  Submit\r\n                </Button>\r\n              </Grid>\r\n            </form>\r\n          )}\r\n        </Paper>\r\n      </Grid>\r\n    </ThemeProvider>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { Redirect, Route, RouteProps } from 'react-router-dom';\r\nimport { useAppState } from '../../state';\r\n\r\nexport default function PrivateRoute({ children, ...rest }: RouteProps) {\r\n  const { isAuthReady, user } = useAppState();\r\n    \r\n  const renderChildren = user || !process.env.REACT_APP_SET_AUTH;\r\n\r\n  if (!renderChildren && !isAuthReady) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={({ location }) =>\r\n        renderChildren ? (\r\n          children\r\n        ) : (\r\n          <Redirect\r\n            to={{\r\n              pathname: '/login',\r\n              state: { from: location },\r\n            }}\r\n          />\r\n        )\r\n      }\r\n    />\r\n  );\r\n}\r\n","import { createMuiTheme } from '@material-ui/core';\r\n\r\ndeclare module '@material-ui/core/styles/createMuiTheme' {\r\n  interface Theme {\r\n    sidebarWidth: number;\r\n  }\r\n\r\n  // allow configuration using `createMuiTheme`\r\n  interface ThemeOptions {\r\n    sidebarWidth?: number;\r\n  }\r\n}\r\n\r\nexport default createMuiTheme({\r\n  palette: {\r\n    type: 'dark',\r\n    primary: {\r\n      main: '#F22F46',\r\n    },\r\n  },\r\n  sidebarWidth: 260,\r\n});\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport { CssBaseline } from '@material-ui/core';\r\nimport { MuiThemeProvider } from '@material-ui/core/styles';\r\n\r\nimport App from './App';\r\nimport AppStateProvider, { useAppState } from './state';\r\nimport { BrowserRouter as Router, Redirect, Route, Switch } from 'react-router-dom';\r\nimport { ConnectOptions } from 'twilio-video';\r\nimport ErrorDialog from './components/ErrorDialog/ErrorDialog';\r\nimport LoginPage from './components/LoginPage/LoginPage';\r\nimport PrivateRoute from './components/PrivateRoute/PrivateRoute';\r\nimport theme from './theme';\r\nimport './types';\r\nimport { VideoProvider } from './components/VideoProvider';\r\n\r\n// See: https://media.twiliocdn.com/sdk/js/video/releases/2.0.0/docs/global.html#ConnectOptions\r\n// for available connection options.\r\nconst connectionOptions: ConnectOptions = {\r\n  bandwidthProfile: {\r\n    video: {\r\n      mode: 'collaboration',\r\n      dominantSpeakerPriority: 'standard',\r\n      renderDimensions: {\r\n        high: { height: 1080, width: 1920 },\r\n        standard: { height: 720, width: 1280 },\r\n        low: { height: 90, width: 160 },\r\n      },\r\n    },\r\n  },\r\n  dominantSpeaker: true,\r\n  maxAudioBitrate: 12000,\r\n  networkQuality: { local: 1, remote: 1 },\r\n  preferredVideoCodecs: [{ codec: 'VP8', simulcast: true }],\r\n};\r\n\r\nconst VideoApp = () => {\r\n  const { error, setError } = useAppState();\r\n\r\n  return (\r\n    <VideoProvider options={connectionOptions} onError={setError}>\r\n      <ErrorDialog dismissError={() => setError(null)} error={error} />\r\n      <App />\r\n    </VideoProvider>\r\n  );\r\n};\r\n\r\nReactDOM.render(\r\n  <MuiThemeProvider theme={theme}>\r\n    <CssBaseline />\r\n    <Router>\r\n      <AppStateProvider>\r\n        <Switch>\r\n          <PrivateRoute exact path={process.env.PUBLIC_URL}>\r\n            <VideoApp />\r\n          </PrivateRoute>\r\n          <PrivateRoute path={process.env.PUBLIC_URL + '/room/:URLRoomName'}>\r\n            <VideoApp />\r\n          </PrivateRoute>\r\n          <Route path={process.env.PUBLIC_URL + '/login'}>\r\n            <LoginPage />\r\n          </Route>\r\n          <Redirect to=\"/\" />\r\n        </Switch>\r\n      </AppStateProvider>\r\n    </Router>\r\n  </MuiThemeProvider>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}